{"4138": {"code": ["in the problem statement$k$$k$-th element of$i$-th element of theis $0$$0$$k$ -th element$2$-th element ofthe$q$ lines$x_i$the$k_i$ of the sequence.oftheoftheto $k$, i.e.in thethe", "thethe sequence is$q$ lines. In thethe sequence is $i$.$x_i$ $0$ \u2014 thea sequenceis giventhethe querythe sequencethe sequence is $q$thethethe sequence isthe firstthethe firstthe $k$thethea $q$$q$ lines$k_i$", "theof thesequence isthe$1$ to $2$$3$-rd element of theelement of the$5$ to $2$.$5$ to $4$.$6$-rd element of theelement of thethethe $5$-th elementof the sequence is$5$ tothetheof the$2$it isof", "the firstof thethetheis giventhe firstthe $1$-st element of the$3$-rd element ofthe $5$-th elementof the sequence$2$-thof thethe$4$-th element of theof the sequenceonethethe $5$-th elementtheof thetheof thesequenceof the", "$q$1.sequence$1$ to $2$.( 1; }0 ;{(, 10 )( $= $[ 1 ],,, $),}.),) ) ; }=(+. length ) ;) { int n =", "thethe sequence isto.(thethe $i$-th element is$k_i$of the sequencethe $i$-th element is$n$thethethe firstthe $1$-th$q$ linesthethe $i$-ththe$k_i$ of thethe $i$-ththetheof the", "of thesequence isoneof the inputof the$0$thethethe $1$-st elementthethetheof thethethe sequence isof $1$-stthe $5$-th element of theof the sequencethe $2$-th element oftheof the sequence isof theof the first line ofis $1$-", "the.;( $1) ) {$5$the sequence isin $1$ to $4$.the firstsequence isthethethe$5$$6$-th element of theis$2$thetheofthethe $i$-th element isthethe $6$-th element of theof the$6", "$i$the $0$-th elementthe $q$ linesthe $1$-th elementisthe $i$-th elementin thetheof thethethethe $1$-th element of thethethe$k_i$thethethethe$x_i$thethethethe $1$-th element is", "$q$sequence..sequence.asequence)( )) )the firstit isthe firstof $i$ $thethe secondnumber of(().(0 ) {( )) { $i$.the first $5$ element of"], "prompt": "\nQUESTION:\nThe only difference between the easy and the hard versions is the maximum value of $k$.\n\nYou are given an infinite sequence of form \"112123123412345$\\dots$\" which consist of blocks of all consecutive positive integers written one after another. The first block consists of all numbers from $1$ to $1$, the second one \u2014 from $1$ to $2$, the third one \u2014 from $1$ to $3$, $\\dots$, the $i$-th block consists of all numbers from $1$ to $i$. \n\nSo the first $56$ elements of the sequence are \"11212312341234512345612345671234567812345678912345678910\". Elements of the sequence are numbered from one. For example, the $1$-st element of the sequence is $1$, the $3$-rd element of the sequence is $2$, the $20$-th element of the sequence is $5$, the $38$-th element is $2$, the $56$-th element of the sequence is $0$.\n\nYour task is to answer $q$ independent queries. In the $i$-th query you are given one integer $k_i$. Calculate the digit at the position $k_i$ of the sequence.\n\n\n-----Input-----\n\nThe first line of the input contains one integer $q$ ($1 \\le q \\le 500$) \u2014 the number of queries.\n\nThe $i$-th of the following $q$ lines contains one integer $k_i$ $(1 \\le k_i \\le 10^{18})$ \u2014 the description of the corresponding query.\n\n\n-----Output-----\n\nPrint $q$ lines. In the $i$-th line print one digit $x_i$ $(0 \\le x_i \\le 9)$ \u2014 the answer to the query $i$, i.e. $x_i$ should be equal to the element at the position $k_i$ of the sequence.\n\n\n-----Examples-----\nInput\n5\n1\n3\n20\n38\n56\n\nOutput\n1\n2\n5\n2\n0\n\nInput\n4\n2132\n506\n999999999999999999\n1000000000000000000\n\nOutput\n8\n2\n4\n1\n\n\n\n-----Note-----\n\nAnswers on queries from the first example are described in the problem statement.\nUse Standard Input format\nANSWER:\n"}}