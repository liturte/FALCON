{"3946": {"code": ["...=- 1.$i$-th picture.the number of) == 0theof $m$thethe$m$.) == 0,) ==, $m$} ) == 0=(i) == 0; }= 0 ; i <", "$n$the$i$-th picture. This is$w_i$$w_i$ isof the$i$-th picture.$n$$m$ isthe$n$the $m$$n$$n$ pictures.aforof $m$ pictures.thethe$m$ and$m$$", "or$n$( $r_i$$r_i$ isthe$n$the number of pictures andto$m$$i$-th picture. If$i$-th picture. Ifthe $i$-th picture.is thewefor a$w_i$ is$i$-th picture. Ifit$n$the", "thetheisinthe; if ($w_i$ > 0$$w_i$is$w_i$ isif $w_i$ =and the number of visits$w_i$ isis$w_i$ isis$w_i$$w_i$ is$w_i$ isthethe number of p", "$n$ pictures and the number$m$$1$ is$1$), where$n$$m$$1$,theofthe$n$ pictures and thenumber of visits to$m$ $n$is$n$$1$,$m$$m$$m$ $n$, $m$$m$", "is aof aof the $i$-ththe$m$in( $0$$m$ is$1$) \u2014 if $a_i$ is$n$and the$m$ is either$n$of the$i$-th picture. If $a_i$ is$a_i$ is eitherif $a_i$", "$i$-th picture. Ifthe$i$-th picture. The$n$$m$$m$of thethethe$n$the$m$ $n$isthe $m$the$m$$m$ $n$ $m$ $n$is$n$the $m$$m$$m$", "=thein the website.$m$if $m$theis$1$) \u2014 ifsheitisas athe $i$-th picture.is{w_i} -{q_i} -in theand the $m$it is guaranteed thatof thetheisin theof the$m$", "$m$$1$, $m$ is$a_1,a_2,\\ldots,a_n$$a_i$ is eitherthe $n$$n$ and$n$ and $m$athe$m$$m$$n$ and $m$$m$$m$ \u2014 if$n$ is either $0$", "if $w_i$$w_i$$m$$n$and $m$ isof the $n$$m$$m$ isofisbe used asshe..$n$the$m$is$m$ isthat it$n$$m$of $m$ visits. \u2014 if"], "prompt": "\nQUESTION:\nThe only difference between easy and hard versions is constraints.\n\nNauuo is a girl who loves random picture websites.\n\nOne day she made a random picture website by herself which includes $n$ pictures.\n\nWhen Nauuo visits the website, she sees exactly one picture. The website does not display each picture with equal probability. The $i$-th picture has a non-negative weight $w_i$, and the probability of the $i$-th picture being displayed is $\\frac{w_i}{\\sum_{j=1}^nw_j}$. That is to say, the probability of a picture to be displayed is proportional to its weight.\n\nHowever, Nauuo discovered that some pictures she does not like were displayed too often. \n\nTo solve this problem, she came up with a great idea: when she saw a picture she likes, she would add $1$ to its weight; otherwise, she would subtract $1$ from its weight.\n\nNauuo will visit the website $m$ times. She wants to know the expected weight of each picture after all the $m$ visits modulo $998244353$. Can you help her?\n\nThe expected weight of the $i$-th picture can be denoted by $\\frac {q_i} {p_i}$ where $\\gcd(p_i,q_i)=1$, you need to print an integer $r_i$ satisfying $0\\le r_i<998244353$ and $r_i\\cdot p_i\\equiv q_i\\pmod{998244353}$. It can be proved that such $r_i$ exists and is unique.\n\n\n-----Input-----\n\nThe first line contains two integers $n$ and $m$ ($1\\le n\\le 2\\cdot 10^5$, $1\\le m\\le 3000$) \u2014 the number of pictures and the number of visits to the website.\n\nThe second line contains $n$ integers $a_1,a_2,\\ldots,a_n$ ($a_i$ is either $0$ or $1$) \u2014 if $a_i=0$ , Nauuo does not like the $i$-th picture; otherwise Nauuo likes the $i$-th picture. It is guaranteed that there is at least one picture which Nauuo likes.\n\nThe third line contains $n$ positive integers $w_1,w_2,\\ldots,w_n$ ($w_i \\geq 1$) \u2014 the initial weights of the pictures. It is guaranteed that the sum of all the initial weights does not exceed $998244352-m$.\n\n\n-----Output-----\n\nThe output contains $n$ integers $r_1,r_2,\\ldots,r_n$ \u2014 the expected weights modulo $998244353$.\n\n\n-----Examples-----\nInput\n2 1\n0 1\n2 1\n\nOutput\n332748119\n332748119\n\nInput\n1 2\n1\n1\n\nOutput\n3\n\nInput\n3 3\n0 1 1\n4 3 5\n\nOutput\n160955686\n185138929\n974061117\n\n\n\n-----Note-----\n\nIn the first example, if the only visit shows the first picture with a probability of $\\frac 2 3$, the final weights are $(1,1)$; if the only visit shows the second picture with a probability of $\\frac1 3$, the final weights are $(2,2)$.\n\nSo, both expected weights are $\\frac2 3\\cdot 1+\\frac 1 3\\cdot 2=\\frac4 3$ .\n\nBecause $332748119\\cdot 3\\equiv 4\\pmod{998244353}$, you need to print $332748119$ instead of $\\frac4 3$ or $1.3333333333$.\n\nIn the second example, there is only one picture which Nauuo likes, so every time Nauuo visits the website, $w_1$ will be increased by $1$.\n\nSo, the expected weight is $1+2=3$.\n\nNauuo is very naughty so she didn't give you any hint of the third example.\nUse Standard Input format\nANSWER:\n"}}