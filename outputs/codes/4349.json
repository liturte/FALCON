{"4349": {"code": [".  public$j$-th\\cdotthethebethe $i$-ththe$1$t_j $, t_j, $0 \\le k_1,of the $i$-th typethe $k_i$ is the$2be on sale,theof the $i$-thtype. It ist_", "the.theisiftoanthe $i$-th typeof thethethe.it isthe $i$-ththeof the $j$-ththe $m$ofthe$k_i$ is the number ofoftheanumber of$k_i$ is the numberof the $i$-th type", "of$1$ burleand $m$the $i$-this the number ofofthetheinthethethethatits typeof theof the $t_j$-th typethe$k_i$ is the number of$i$-th typethe $n$ typeof thetype Ivannumber ofa", "a$n$microtransactionsin theis given as a pairnumberof types ofwe want toallmicrotransactions of the $i$-thit is giventhe $i$-th typebethe $n$thetypethe $i$-tht_j$-th typeandof the $i$-th type.the $k_i$ is", "microtransactions in thethey arein theallin thethe $m$the $i$-th type.of the$n$ isthe$k_1, k_2, k_n$the $i$-th type Ivant_j, n$).thetypeatype,the $i$-th type,thethe$", "thethe.$1$ burlecan buythe $i$-th type.a pair of integersofthe $n$ types in the.$k_i$ is the number ofthe $i$-th typetypethe $i$-thnumber ofand $k_i$ isthe $k_i$of the$n$to", "inthe$n$thetheit isthe)\\le n, m2 \\cdot 10^5$,the $k_i$the(d_j, t_j)$thetype isof the$n$\\le n,\\le n, m \\le n$of the$j$-thbetheof the", "is given as aofday.thet_j$-th typetype isthe$k_i$ is the$n$number ofofthe $i$-th typetypeis given as a$n$ numbers $k_1, k_2,number of copies ofthe$i$-th type Ivanis given as$n$number", "$k_i$theof the $i$-ththeisthe.a$n$type,all $k_i$thetype,themicrotransactions for $i$-th typethe $n$$m$the $m$the $m$it isthe $k_i$ type,the $n$$n$", "the $m$beit$2$ burles./( 0k_1k_2, k_2,\\cdot 10^5$) \u2014 the$n$ is thenumber of copies of\\lethe $i$-th typein the game\\le 2 \\cdot 10^5$)thewetothe $i"], "prompt": "\nQUESTION:\nThe only difference between easy and hard versions is constraints.\n\nIvan plays a computer game that contains some microtransactions to make characters look cooler. Since Ivan wants his character to be really cool, he wants to use some of these microtransactions \u2014 and he won't start playing until he gets all of them.\n\nEach day (during the morning) Ivan earns exactly one burle.\n\nThere are $n$ types of microtransactions in the game. Each microtransaction costs $2$ burles usually and $1$ burle if it is on sale. Ivan has to order exactly $k_i$ microtransactions of the $i$-th type (he orders microtransactions during the evening).\n\nIvan can order any (possibly zero) number of microtransactions of any types during any day (of course, if he has enough money to do it). If the microtransaction he wants to order is on sale then he can buy it for $1$ burle and otherwise he can buy it for $2$ burles.\n\nThere are also $m$ special offers in the game shop. The $j$-th offer $(d_j, t_j)$ means that microtransactions of the $t_j$-th type are on sale during the $d_j$-th day.\n\nIvan wants to order all microtransactions as soon as possible. Your task is to calculate the minimum day when he can buy all microtransactions he want and actually start playing.\n\n\n-----Input-----\n\nThe first line of the input contains two integers $n$ and $m$ ($1 \\le n, m \\le 2 \\cdot 10^5$) \u2014 the number of types of microtransactions and the number of special offers in the game shop.\n\nThe second line of the input contains $n$ integers $k_1, k_2, \\dots, k_n$ ($0 \\le k_i \\le 2 \\cdot 10^5$), where $k_i$ is the number of copies of microtransaction of the $i$-th type Ivan has to order. It is guaranteed that sum of all $k_i$ is not less than $1$ and not greater than $2 \\cdot 10^5$.\n\nThe next $m$ lines contain special offers. The $j$-th of these lines contains the $j$-th special offer. It is given as a pair of integers $(d_j, t_j)$ ($1 \\le d_j \\le 2 \\cdot 10^5, 1 \\le t_j \\le n$) and means that microtransactions of the $t_j$-th type are on sale during the $d_j$-th day.\n\n\n-----Output-----\n\nPrint one integer \u2014 the minimum day when Ivan can order all microtransactions he wants and actually start playing.\n\n\n-----Examples-----\nInput\n5 6\n1 2 0 2 0\n2 4\n3 3\n1 5\n1 2\n1 5\n2 3\n\nOutput\n8\n\nInput\n5 3\n4 2 1 3 2\n3 5\n4 2\n2 5\n\nOutput\n20\nUse Standard Input format\nANSWER:\n"}}