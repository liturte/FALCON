{"1683": {"code": ["the\\dots b_q$$f(b_1 b_2 \\dots1} b_{p -b_{q -1} b_{q+ 1} a_1$f(a_1 a_2 \\dots a_p, b_1\\dots b_q) = b_1 a_2a_{p -+ 1} a_2 \\dots", "/ a_2 \\)= 1= 2222 $$f(7777, 888)1} a_1 a_21} b_1 b_2 \\dots\\dots a_{p- p + 2} a_11} a_2 \\dots-\\dots$f(a_1 \\dots a_p, b_1\\dots b", "-$f (\\dots b_q$ = b_1b_2a_p b_q$; ( a_1 \\dots a_p,b_1 b_2 \\dots a_{p-p +b_1 b_2 \\dots a_{p$f(b_1 \\dotsa_{p -b_1 b_{q", "$p - 1}a_1\\dots b_q$; $f(a_1 a_2 a_p, b_1 b_2b_1b_{q - 1} a_1 b_{q-a_p- 1} b_{q -- 1} a_{p -- p2} b_1 a_{p -1} b_{", "(- 1} a_{p -=- 1}\\dots b_q$ ;)\\dots$f(a_1 \\dotsa_1 a_{p - q +2} b_1\\dots a_{p -1} a_{p-b_{q -b_{q\\dots b_q) = b_1 b_2", "a_2 a_2 b_2 a_n$ and\\dots b_q$ =1} a_2 b_{q - 1}a_1 b_2a_{p -$f(a_1 a_2 a_1 a_2 b_1a_{p -a_1 a_2 b_2 b_q$a_1 a_2 b_2 a_", "- 1} b_{q -1} b_{q - 1}a_1 a_2\\dots b_q$; $f(a_1\\dots a_p, b_1 b_2 \\dots-- 1}\\dots b_{q -a_1a_1 b_2 \\dotsb_1a_{p -1", "$f(a_1 a_2 b_1 a_2\\ dots= a_1 a_2 b_2a_{p - 1} b_{q1} a_{p1} b_{q -1} a_{p -1} b_{p -) ;if $p \\ge q$= a_1 a_2 \\dotsb_{q - p +", "the$f(a_1\\dots a_{p -2} a_1 a_{p -1} b_{q -a_1 a_2 \\dots$f(a_1 a_2\\dots a_{p -a_{p-a_{p -1} b_{q -\\dots a_{p- 1} b_{p- 1}", "- 1} b_{p1} b_{p-1} b_{pb_2 \\dots a_{p-- 1} b_{q -\\dots b_{q -a_1 a_2 \\dotsa_1 b_2a_{p -b_{q - 1} a_2\\dots b_{q -- 1} a_2 \\d"], "prompt": "\nQUESTION:\nThis problem differs from the previous one only in the absence of the constraint on the equal length of all numbers $a_1, a_2, \\dots, a_n$.\n\nA team of SIS students is going to make a trip on a submarine. Their target is an ancient treasure in a sunken ship lying on the bottom of the Great Rybinsk sea. Unfortunately, the students don't know the coordinates of the ship, so they asked Meshanya (who is a hereditary mage) to help them. He agreed to help them, but only if they solve his problem.\n\nLet's denote a function that alternates digits of two numbers $f(a_1 a_2 \\dots a_{p - 1} a_p, b_1 b_2 \\dots b_{q - 1} b_q)$, where $a_1 \\dots a_p$ and $b_1 \\dots b_q$ are digits of two integers written in the decimal notation without leading zeros.\n\nIn other words, the function $f(x, y)$ alternately shuffles the digits of the numbers $x$ and $y$ by writing them from the lowest digits to the older ones, starting with the number $y$. The result of the function is also built from right to left (that is, from the lower digits to the older ones). If the digits of one of the arguments have ended, then the remaining digits of the other argument are written out. Familiarize with examples and formal definitions of the function below.\n\nFor example: $$f(1111, 2222) = 12121212$$ $$f(7777, 888) = 7787878$$ $$f(33, 44444) = 4443434$$ $$f(555, 6) = 5556$$ $$f(111, 2222) = 2121212$$\n\nFormally,  if $p \\ge q$ then $f(a_1 \\dots a_p, b_1 \\dots b_q) = a_1 a_2 \\dots a_{p - q + 1} b_1 a_{p - q + 2} b_2 \\dots a_{p - 1} b_{q - 1} a_p b_q$;  if $p < q$ then $f(a_1 \\dots a_p, b_1 \\dots b_q) = b_1 b_2 \\dots b_{q - p} a_1 b_{q - p + 1} a_2 \\dots a_{p - 1} b_{q - 1} a_p b_q$. \n\nMishanya gives you an array consisting of $n$ integers $a_i$, your task is to help students to calculate $\\sum_{i = 1}^{n}\\sum_{j = 1}^{n} f(a_i, a_j)$ modulo $998\\,244\\,353$.\n\n\n-----Input-----\n\nThe first line of the input contains a single integer $n$ ($1 \\le n \\le 100\\,000$) \u2014 the number of elements in the array. The second line of the input contains $n$ integers $a_1, a_2, \\dots, a_n$ ($1 \\le a_i \\le 10^9$) \u2014 the elements of the array.\n\n\n-----Output-----\n\nPrint the answer modulo $998\\,244\\,353$.\n\n\n-----Examples-----\nInput\n3\n12 3 45\n\nOutput\n12330\nInput\n2\n123 456\n\nOutput\n1115598\nUse Standard Input format\nANSWER:\n"}}