{"1793": {"code": ["thethein1theto $1$ andinthein $n$thethethethe parent of the$n$the$L$, $S$, $n$, $L$,$p_i$,$p_i$ is thethethe$S$ and $n$ are thethe$w_i$ is", "$n$$n$$n$$S$ $L$thethe number of2$the number ofthe({n$, w_1, w_2,\\le0$).2$.2$) is the$n$the\\le\\le$n$ and $S$theis$n$ orin a", "$n$ vertices\\lethe number ofthethe number ofin the++$-1$\\le\\le$n$$w_i$ $S$$n$ vertices of$w_i$\\le 10^9$)\u00a0\u2014 the number$n$ vertices of$p_i$ $n$ $n$$w_", "$n$.  function); if ()).= 1.0).0 ) { $.}) ) ;if (!) {$(} else( ) ) {.(1.0 ) ; } }.( )) ; }.", "the{[\\\\le 10^{18}$),thethe number of().$n$ $w_i$$p_2,=$w_i$ $w_k$ $p_2$ $w_i$ $w_k$$w_k$ $w_i$ $w_k$ $w_k$$p_i$", "the={()[ 2 ]== ( $w_i2 ]if ( $w_i$ <)} $w_i$ =()= ( $w_i2;2 ] [ 2] = ()),, 2 ][ 2 ]] = ( $w_i] = ( $w_", ".\\w$2$ or\\w_i$ is the- 1$\\w$\\w_i$ is$p_2\\w$ $w_i$ is the.( $n\\w$.\\w$\\w_i$ $p_i$ $1 \\le\\w_i$ $1 \\le$1 \\le\\w", "the(thethepath{ $n$13( $n$$n$$n$) {{ $n$ - 1$}} $w_i$ $w_i$ $S$$w_i$$n$ $S$) { $w_i$$n$ -)}) { $w_i$", "$n$ verticesn - 1$$L$$S$\\le\\le\\le 10^9$)\u00a0\u2014 the(n\\le 10^9$)\u00a0\u2014 the$n$\\le$n$=$w_i$$n$ vertices $w_i$ $S$\\le 10^9$)\u00a0\ufffd", "($w_i$$n$ $L$\\le$S$\\lethetheofanumberthe$S$ $L$ $S$ $S$\\lenumber of vertices of thetheofthe$S$ $S$ $S$\\le\\lethe( $i$S$the$n$ $"], "prompt": "\nQUESTION:\nYou are given a rooted tree on $n$ vertices, its root is the vertex number $1$. The $i$-th vertex contains a number $w_i$. Split it into the minimum possible number of vertical paths in such a way that each path contains no more than $L$ vertices and the sum of integers $w_i$ on each path does not exceed $S$. Each vertex should belong to exactly one path.\n\nA vertical path is a sequence of vertices $v_1, v_2, \\ldots, v_k$ where $v_i$ ($i \\ge 2$) is the parent of $v_{i - 1}$.\n\n\n-----Input-----\n\nThe first line contains three integers $n$, $L$, $S$ ($1 \\le n \\le 10^5$, $1 \\le L \\le 10^5$, $1 \\le S \\le 10^{18}$)\u00a0\u2014 the number of vertices, the maximum number of vertices in one path and the maximum sum in one path.\n\nThe second line contains $n$ integers $w_1, w_2, \\ldots, w_n$ ($1 \\le w_i \\le 10^9$)\u00a0\u2014 the numbers in the vertices of the tree.\n\nThe third line contains $n - 1$ integers $p_2, \\ldots, p_n$ ($1 \\le p_i < i$), where $p_i$ is the parent of the $i$-th vertex in the tree.\n\n\n-----Output-----\n\nOutput one number \u00a0\u2014 the minimum number of vertical paths. If it is impossible to split the tree, output $-1$.\n\n\n-----Examples-----\nInput\n3 1 3\n1 2 3\n1 1\n\nOutput\n3\nInput\n3 3 6\n1 2 3\n1 1\n\nOutput\n2\nInput\n1 1 10000\n10001\n\nOutput\n-1\n\n\n-----Note-----\n\nIn the first sample the tree is split into $\\{1\\},\\ \\{2\\},\\ \\{3\\}$.\n\nIn the second sample the tree is split into $\\{1,\\ 2\\},\\ \\{3\\}$ or $\\{1,\\ 3\\},\\ \\{2\\}$.\n\nIn the third sample it is impossible to split the tree.\nUse Standard Input format\nANSWER:\n"}}