{"2773": {"code": [". This istheit's atheintersections, and$n$between thethose that arein$n$andtheintersections thatin the order in whichthe pathisthetheof thethethe difference between thethethreeof thepath in the orderin which they are crossed,a path that isthethe", "== 0$of theisbethe= 1$thethey arefrom thethethe path to Amsterdam( $0$n$ $n$ $n$ $n$$n$ $n$ $n$ $n$$n$ $n$ $n$ $n$( $0 \\le\\le$m$ $n$ $", "the busthe.of theandpath is$p_0 =thethethe path, withthe paththe intersection along thethe path isA pathis specified bythe patha path,of theintersections along thea paththethethepath, andsides of the path, and$k$ and $p_{k}=1$", "thetheto theof thethein theof theallof theof thein thetheof thethean emptyof thea pathisof thetheall of thetheof thethe bustheof the direction of the", "thethein thethethetheisintersections along the path.thepatharefrom thethe path,in the order in whichthein whichthe path isthatistheaa routesuch that thewillof thethe bus and that theisof thethe path to Amsterdamintersections that are connected to", "thethethethethe-thebetween thein thethethey are connected toin theintersections are numbered fromthebetweenthetheof the path.thatintersections along the paththe pathall thethose that are connected bythe bus, in$p_{k-1}=1$.of the path is the", "beingthe busthetheof thethethethetheintersections along the( $s_ i$the paththeandof the path, thatof thethe busthetheinthethe bus isthe path tothetheby the same direction,(of theof the path to thethe direction of Amsterdam.", ".. to the)thethepath isAof the$s_i$ $s_i$ $s_i$ $s_i$the= 1$ and$s_i$ $s_i$ $s_i$$s_i$ $s_i$ $s_s_i$the path$s_i$ $s_", "in the) ).the busbeof thethefor eachintersections along the$p_0 = 0$ and $p_{k-1}A path fromto Amsterdam that satisfies thefor eachpath is specified by$q_i$, $q_i$, $q_i$$d_ i$, $q_ i$,$p_{k", "thethein thethethe)of theof theof thethe direction ofthein thethetheintersections.theisthe path totheybein the order in which//the direction of thethethe direction ofthe direction of the directiontheof the path tothe path,the direction of the"], "prompt": "\nQUESTION:\nAfter last year\u2019s edition of the BAPC, you are still stuck in Delft. In order to participate again this year, you are going to Amsterdam by bus. During the journey you look out of the window and look for traffic signs that point in the direction of Amsterdam. To your surprise, you notice that the bus is never taking the roads that are pointed out by the signs!\n\nYou think that the bus company might have chosen a route such that, at no intersection, the bus goes in the direction that is pointed to by the signs. Your friends, however, find this very unbelievable, and don\u2019t think this is possible. Can you figure out whether there exists a bus route that satisfies this requirement? Note that a bus route never visits the same place twice.\n\nA traffic sign pointing in the direction of the shortest route to Amsterdam is placed at every intersection. You may assume that the input graph is both simple and connected, and that there is a unique optimal route to Amsterdam from every intersection.\n\n-----Input-----\n - A single line containing two integers: $n$ ($2 \\le n \\le 10^5$), the number of intersections, and $m$ ($1 \\le m \\le 10^6$), the number of undirected roads that connect the intersections. The intersections are numbered from $0$ to $n-1$. Delft is denoted by intersection $i=0$ and Amsterdam is denoted by intersection $i=1$.\n - $m$ lines that specify the roads\n - A road is specified by three integers, $a_ i$, $b_ i$ ($0 \\leq a_ i, b_ i < n$ and $a_ i \\ne b_ i$) and $d_ i$ ($0 \\le d_ i \\leq 500000$), where $a_ i$ and $b_ i$ are ids of the two intersections that are connected by this road and $d_ i$ is the distance that the bus has to travel to get from $a_ i$ to $b_ i$ or vice versa.\n\n-----Output-----\nAs output, give one of the following:\n - A path from Delft to Amsterdam that satisfies the requirements, in case such a path exists.\n - A path is specified by a single line containing an integer $k$, the length of the path, followed by $k$ integers $p_ i$ that specify the intersections along the path in the order in which they are crossed, with $p_0 = 0$ and $p_{k-1}=1$.\n - The text \u201cimpossible\u201d, if such a path does not exist.\n\n-----Examples-----\nSample Input 1:\n4 5\n0 2 5\n2 1 5\n0 3 10\n3 1 20\n3 2 5\nSample Output 1:\n3 0 3 1\n\nSample Input 2:\n4 3\n0 1 10\n1 2 20\n2 3 30\nSample Output 2:\nimpossible\nUse Standard Input format\nANSWER:\n"}}