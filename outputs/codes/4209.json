{"4209": {"code": ["(a[l, a[l+1]),the$l_2+1]+\\dots+a[r_2]=$$ $$\\dots =$$ $$a[l_1]+a[l_1+1]+\\dots+a[r_1]=$$the$n$$n$\\le$a[1], a[2],\\le\\le 1500$", "theblocks in the$n$ $1 \\le$n$ $1 \\le l_ia_j, r_j)$.\\le l$a[l]$ ($1 \\le lthethe first linethe firstthe first linethe second linethethe\\le l_i \\le\\le\\lethethe(l_i,\\", "in the$l_1$ $l_2$$l_i$ $r_i$ $l_j$a_k$the\\le $k$ \u2014 the\\le $n$$a[1], a[2], \\dots, a[n]$a_k$the number of theof thethe block in the$n$ ($2 \\", "theaarray of integersa [ 1a[2], \\dots, a[n]$ ($-10^5 \\lea_i \\le 10^5$).$1 \\le$n$ ($-10^5\\le\\le(a_i,a[1], a[2],\\le 10^5$).\\le\\lethe(a", "\\le a_ia_i \\le$n$\\hline \\hline \\hline \\hline$n$ (l_1, r_1),a_i\\le$n$ (l_1, r_1) \\hlinetheof blocks$n$ (l_1, r_1),$n$$n$ (l_2, r_2", "$n$ $1 \\lethe$l_i $$l_j\\le\\le\\le\\le\\le\\le 1500$).\\le 1500$). \\hline \\begin{array}{|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l", "the$$ $ \\{2} & {2}{3} &\\hline \\begin{array}{|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|", "$k$ \u2014 the length\\le\\le 10^5$).$l_j$ )$l_i$ and $l_j$\\le$l_j$\\le$l_i$thethethe second line containsthea_j$).(l_i,\\le\\le$r_j$ )isthe", "theof elements$a[l]$ ($1 \\le la_ithethe sequence of elementsa[2]$ ($-10^5 \\lea_i \\le 10^5$).$(10^5 \\le a_i$(10^5 \\le a_i \\le$(10^5 \\le\\lea_i \\le 10^5$).", "$(l_1, r_1)the sequence of elements\\lethethe{2} & {3}\\lethe\\lethe$(l, r)$(l, r)$.thethe secondthe given array.array. Ablock is defined by athe$(l, r)$.$(l, r_i)$).("], "prompt": "\nQUESTION:\nThis problem is given in two editions, which differ exclusively in the constraints on the number $n$.\n\nYou are given an array of integers $a[1], a[2], \\dots, a[n].$ A block is a sequence of contiguous (consecutive) elements $a[l], a[l+1], \\dots, a[r]$ ($1 \\le l \\le r \\le n$). Thus, a block is defined by a pair of indices $(l, r)$.\n\nFind a set of blocks $(l_1, r_1), (l_2, r_2), \\dots, (l_k, r_k)$ such that:  They do not intersect (i.e. they are disjoint). Formally, for each pair of blocks $(l_i, r_i)$ and $(l_j, r_j$) where $i \\neq j$ either $r_i < l_j$ or $r_j < l_i$.  For each block the sum of its elements is the same. Formally, $$a[l_1]+a[l_1+1]+\\dots+a[r_1]=a[l_2]+a[l_2+1]+\\dots+a[r_2]=$$ $$\\dots =$$ $$a[l_k]+a[l_k+1]+\\dots+a[r_k].$$  The number of the blocks in the set is maximum. Formally, there does not exist a set of blocks $(l_1', r_1'), (l_2', r_2'), \\dots, (l_{k'}', r_{k'}')$ satisfying the above two requirements with $k' > k$.  $\\left. \\begin{array}{|l|l|l|l|l|l|} \\hline 4 & {1} & {2} & {2} & {1} & {5} & {3} \\\\ \\hline \\end{array} \\right.$ The picture corresponds to the first example. Blue boxes illustrate blocks. \n\nWrite a program to find such a set of blocks.\n\n\n-----Input-----\n\nThe first line contains integer $n$ ($1 \\le n \\le 1500$) \u2014 the length of the given array. The second line contains the sequence of elements $a[1], a[2], \\dots, a[n]$ ($-10^5 \\le a_i \\le 10^5$).\n\n\n-----Output-----\n\nIn the first line print the integer $k$ ($1 \\le k \\le n$). The following $k$ lines should contain blocks, one per line. In each line print a pair of indices $l_i, r_i$ ($1 \\le l_i \\le r_i \\le n$) \u2014 the bounds of the $i$-th block. You can print blocks in any order. If there are multiple answers, print any of them.\n\n\n-----Examples-----\nInput\n7\n4 1 2 2 1 5 3\n\nOutput\n3\n7 7\n2 3\n4 5\n\nInput\n11\n-5 -4 -3 -2 -1 0 1 2 3 4 5\n\nOutput\n2\n3 4\n1 1\n\nInput\n4\n1 1 1 1\n\nOutput\n4\n4 4\n1 1\n2 2\n3 3\nUse Standard Input format\nANSWER:\n"}}