{"2777": {"code": ["of the sequence$p_\\le\\le \\!$i$$i$$x_ i$ in$i$ in$2^m$ is the$i$ in the$n$theof the$i$ in thesequence.$x_ i$ in$x_ i$in onesequence. The$i$ in$x$", "number $p$$x_ i$ inone $p$ sequence.$p$ sequencethenumbera single integer$p$ sequence, which isone$p$ sequence, which is$p$ sequence,sequence, which is$x_ i$ in$n$ is the$n$ is the$p$ sequence,$p$ sequence, which isthein", "$m$atwo $m$$n$$i$ insequence in$n$ inthe$n$$n$thelength ofthe $p$$2^m$is the length ofthe $m$$i$( $1$ \\le \\!\\le \\!$2^m$$n$ is the$n$", "$p_2^m$in $m$ and $n$$x$ sequences.$i$ $2^m$ $n$$i$ in$m$sequence.and $n$ $2^m$ $p$ ($1\\!\\le \\!\\le \\!\\le \\! n$between two $2^m$sequence,$m$ and", "$p_ 0,thesequence$p$ sequencethesequence$n$in the$p$the sequence $x_1,\\le \\! m$,$2^m$$p$ sequence, $p$ sequence,$p$ sequence, $n$$p$ sequence, $p$\\le \\! n$$n$ in thesequence$", "sequence.$p$the$i$ in thesequence.$p_thesequence, $p$ $2^m$of the$n$$p_ 0,$p$ sequence, $p_$1$ to $n$ inclusivethe sequence $p_ 0,sequence, in order.the $x$sequence, in order.ofof thesequence", "$p$ sequence$p$ sequence,of thesequence. $p$ sequence, $p$ sequenceof thenumbers.the sequencethesequence,sequence,$p$ sequence, $p$ sequence,length of the $p$sequence, $p$sequence, $p$ sequence,$p$ sequence,of the $2^m$ lines$n$\\le \\", "$p$ sequence.$1$ to $n$ inclusive.thetheof$p$ sequence.$p$ sequence, $m$$n$the$n$( $0$$m$, $n$$n$thethe sequence.$m$ sequences$n$$2^m$$n$ $1$ is thethe$", "$p$ sequence,$x$ sequences. The sequencesequence $p_0,$p_ 1,$i$ in\\le \\!andin$n$\\le \\!sequencetheof$p$ sequence,$p$ sequence,$p$ sequence,in $p$$m$\\le$x$ sequences,the $x$ sequences", "sequence( $1$$p$ sequence,$p$ sequence.$2^m$ is theof thesequence,$2^m$$n$ is the length$1$ to $n$ inclusivetwoand $n$(the$2^m$$p$$1$ to$n$$p$ sequence,the $p$ sequence,"], "prompt": "\nQUESTION:\nSuppose you are given two integers, $m$ and $n$. You are also given a list of $n$ distinct integers $x_1, x_2, \\ldots , x_ n$, with $0\\! \\le \\! x_ i\\! \\le \\! 2^m{-}1$. For each number $y$ from $0$ to $2^m{-}1$, you\u2019ve found the number $p_ y$ such that $x_{p_ y}$ has a maximum bitwise-$\\operatorname {XOR}$ with $y$. That is, $y\\! \\oplus \\! x_{p_ y}\\! >\\! y\\! \\oplus \\! x_ i$ for all $i\\! =\\! 1..n, i\\! \\neq \\! p_ y$ ($\\oplus $ means bitwise-$\\operatorname {XOR}$).\n\nNow, consider the reverse problem. Given $m$, $n$, and the sequence $p_0, p_1, \\ldots , p_{2^m{-}1}$, count the number of sequences of distinct integers $x_1, x_2, \\ldots , x_ n$ that could have generated that $p$ sequence from the above algorithm. Two $x$ sequences are different if there is some $i$ such that $x_ i$ in one sequence is different from $x_ i$ in the other sequence. Output this count modulo $10^9{+}7$.\n\n-----Input-----\nEach test case will begin with a line with two space-separated integers $m$ ($0\\! \\le \\! m\\! \\le \\! 16$) and $n$ ($1\\! \\le \\! n\\! \\le \\! 2^m$), where $2^m$ is the length of the $p$ sequence, and $n$ is the length of the $x$ sequences.\n\nEach of the next $2^m$ lines will contain a single integer $p$ ($1\\! \\le \\! p\\! \\le \\! n$). These are the values of the sequence $p_0, p_1, \\ldots , p_{2^m{-}1}$, in order. Every value from $1$ to $n$ inclusive will appear at least once.\n\n-----Output-----\nOutput a single integer, which is the number of sequences $x_1, x_2, \\ldots , x_ n$ which could have generated the sequence $p_0, p_1, \\ldots , p_{2^m{-}1}$ from the above algorithm, modulo $10^9{+}7$.\n\n-----Examples-----\nSample Input 1:\n3 6\n1\n1\n2\n2\n3\n4\n5\n6\nSample Output 1:\n4\n\nSample Input 2:\n2 3\n1\n2\n1\n3\nSample Output 2:\n0\nUse Standard Input format\nANSWER:\n"}}