{"376": {"code": ["thetheof the banks.the bank isathe bank ismuchtheandisittheand the strength of thethe bank isthe bank isthein the..[Image ]....:. length - 1", "the banks,the banks,athea_2,...,the banks,theof a bank x.the strength ofhigher than the strength(1 \u2264thebank(1 \u2264the...a_1a_2,..., a_{n} (1(1 \u2264 a_2 ", "n - 1 linesn -the wires connect thethe banks.theistheof theofthe=thethe firstand the next n.( 1 \u2264; }if ( a_1and a_2 \u2264 a_{n} \u2264).a_1 = a_2.a_1.", "the banks.the banks in.banks thathaven't beenthe) {{.bank_n_1, bank_n_2,.;.:bank_n_1 =,bank_n_2, bank_n_2 =; ifthea_1, a_2,..., a_{n}the strength of", "of ahadif thethe bank(12\u00b710^9)\u00a0\u2014 the strength ofisstrength of theisa.0 ) ; }thethe bankstheandthatthethe banksthe strength of theof the banksthe banks of theof the banks. Thestrength of the banks", "the banks.andthe banks:.................,.. add (. add (. add ( 2 )", "the banks.of the.thebanksthen -(1and v_{i}the strengths of..( n....; if (.. add () ) ; }. add (. add (. add (. add (. add ( a_i", "one bankthethe banks that area_1 and a_2onethenumber ofn - 1 linesthe(1 \u2264na_{n}a_{i}.1,, a_{n}a_{n} \u2264 a_{n}the banks1, a_{n} \u2264 a_{n}the bank", "inthe bankstheand the(1andthe banksfortheof thethethethein thethewetheof the n-1thethe number of banks inin the numbered numbered banksthe numbered banks,we need to(1 \u2264 n \u2264the numbered banksn -", "the banks1of.thenumber ofthemalicious:: :: : : :: : : :: : :: : : :: : : :: : : ::::: :: : :::::: : : :"], "prompt": "\nQUESTION:\nAlthough Inzane successfully found his beloved bone, Zane, his owner, has yet to return. To search for Zane, he would need a lot of money, of which he sadly has none. To deal with the problem, he has decided to hack the banks. [Image] \n\nThere are n banks, numbered from 1 to n. There are also n - 1 wires connecting the banks. All banks are initially online. Each bank also has its initial strength: bank i has initial strength a_{i}.\n\nLet us define some keywords before we proceed. Bank i and bank j are neighboring if and only if there exists a wire directly connecting them. Bank i and bank j are semi-neighboring if and only if there exists an online bank k such that bank i and bank k are neighboring and bank k and bank j are neighboring.\n\nWhen a bank is hacked, it becomes offline (and no longer online), and other banks that are neighboring or semi-neighboring to it have their strengths increased by 1.\n\nTo start his plan, Inzane will choose a bank to hack first. Indeed, the strength of such bank must not exceed the strength of his computer. After this, he will repeatedly choose some bank to hack next until all the banks are hacked, but he can continue to hack bank x if and only if all these conditions are met:  Bank x is online. That is, bank x is not hacked yet.  Bank x is neighboring to some offline bank.  The strength of bank x is less than or equal to the strength of Inzane's computer. \n\nDetermine the minimum strength of the computer Inzane needs to hack all the banks.\n\n\n-----Input-----\n\nThe first line contains one integer n (1 \u2264 n \u2264 3\u00b710^5)\u00a0\u2014 the total number of banks.\n\nThe second line contains n integers a_1, a_2, ..., a_{n} ( - 10^9 \u2264 a_{i} \u2264 10^9)\u00a0\u2014 the strengths of the banks.\n\nEach of the next n - 1 lines contains two integers u_{i} and v_{i} (1 \u2264 u_{i}, v_{i} \u2264 n, u_{i} \u2260 v_{i})\u00a0\u2014 meaning that there is a wire directly connecting banks u_{i} and v_{i}.\n\nIt is guaranteed that the wires connect the banks in such a way that Inzane can somehow hack all the banks using a computer with appropriate strength.\n\n\n-----Output-----\n\nPrint one integer\u00a0\u2014 the minimum strength of the computer Inzane needs to accomplish the goal.\n\n\n-----Examples-----\nInput\n5\n1 2 3 4 5\n1 2\n2 3\n3 4\n4 5\n\nOutput\n5\nInput\n7\n38 -29 87 93 39 28 -55\n1 2\n2 5\n3 2\n2 4\n1 7\n7 6\n\nOutput\n93\nInput\n5\n1 2 7 6 7\n1 5\n5 3\n3 4\n2 4\n\nOutput\n8\n\n\n-----Note-----\n\nIn the first sample, Inzane can hack all banks using a computer with strength 5. Here is how:  Initially, strengths of the banks are [1, 2, 3, 4, 5].  He hacks bank 5, then strengths of the banks become [1, 2, 4, 5,  - ].  He hacks bank 4, then strengths of the banks become [1, 3, 5,  - ,  - ].  He hacks bank 3, then strengths of the banks become [2, 4,  - ,  - ,  - ].  He hacks bank 2, then strengths of the banks become [3,  - ,  - ,  - ,  - ].  He completes his goal by hacking bank 1. \n\nIn the second sample, Inzane can hack banks 4, 2, 3, 1, 5, 7, and 6, in this order. This way, he can hack all banks using a computer with strength 93.\nUse Standard Input format\nANSWER:\n"}}