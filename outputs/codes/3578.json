{"3578": {"code": ["itthetellstheweathea food thatin the input.thethetheof theof theof theof thethethein the input. The=the number ofwe need tothe food inthe food inofthese flights. It is a", "thethethenumbered.0, 0,thethethethe\\dots, N$ and Stockholm hasofoneonethethethat wetheone, theof the Frida, andof the Fridathe flightsin both directions.of the flightswill make all thethe", "..,.frida,$1$) {, a.( ) )...0.0001, 1.0001,.., a.,,, 0.0001,0.0001, 0.0001, 0.0001, $a$$a$ denote 1 distinct$a$ denote 1 distinct", "thea singlethethatthe; }( a1 )= 2 *A= 2 * AA=.= 2 *, 1,1 ) ;1.1 ] ) ) ;1, 1 )() ; }0 ) { if() ) {", "theittheflights.thethethethein the input,(2\\leq a,N, 1\\leq\\leq A, 2\\leqof(2\\leq), $a, b$ denote 2$a$ denotethe.= 0 ; i <; i ++ ).] =[ i]", "ifall theweatheof thein the inputthethat thetheathethetheof thethethecan bethea1, $b$$c$ can beof the foodthetheof the food, so wethe correct order.of thethe food in boththe flights that are", "caninshetheboss istheofoftheinin the input.one or moreof theflights to review. Thea, b, c,(1\\leq a, b\\leq N,$b$ denotetheof the foodtheof theoneof the foodthe food onthea", ". reviewsflights thatin) ;} ) ; }( 'Herisflights in Swedish. add () ;( 'R$) ; } };,) {.( 'R$[] ; }( 'R$1' ) ;$) ; }) ; }: { 'A'", "., 1 )one, 2 )a, 2 )) {( ) ;[ ][ ] ;(][ ] )] ; for (] ) {}for] ; }] ) ) {[[ ] ) ;] ; }=1 ] ;] ; } if (] ) ; }.", "for(1\\leq A, 2\\leqatheandflights in the input.$A$ is the totalflightsin the input.thethethethe numberedaare numberedof$R$for thetheflights tothethethe... A,"], "prompt": "\nQUESTION:\nNote that this is a bit harder version of the problem foodreview.\n\nFrida is a writer for Cosmopolitan who writes restaurant reviews. She enjoys it a lot, but it seems that, throughout the years, she has reviewed all the restaurants on Earth. It\u2019s now time to move one level up; she is going to review the food served by the airlines, so that the readers can make better decisions on which flights to take.\n\nHer boss gave her a list of flight connections that she needs to review for the upcoming issue of Cosmopolitan. She knows that they serve the same food in both directions of every flight, so she only needs to take it once. She realized that she will need to take some additional flights, because she can not make all reviews using only flights in the list from her boss. Therefore she did some quick research and made a list of additional flights which she might take. She will not review the food on these flights; they will only be used so that she can make all the reviews.\n\nFrida\u2019s goal is to make all the reviews while spending the least money on flight tickets. Her office is in Stockholm, so she starts and ends her journey there. Each flight is both ways between two cities and has a fixed price in both directions. You can assume that it is possible to make all the reviews using some of the additional flights.\n\nFor the purposes of this problem we ignore the price Frida has to pay for accommodation and we also ignore the departure and arrival times of flights by assuming that every flight is very often and reasonably short. We only focus on the total price of the flights.\n\n-----Input-----\nThe first line contains $2$ space separated integers $N, R, (2\\leq N\\leq 15, 0\\leq R\\leq 105)$, where $N$ is the number of airports mentioned in the input and $R$ is the number of flights to review. The airports are numbered $1, \\dots , N$ and Stockholm has number $1$.\n\nThe next $R$ lines describe the $R$ flights to review. Each line contains 3 space separated integers $a, b, c, (1\\leq a, b\\leq N, 1\\leq c\\leq 10000)$, where $a, b$ denote 2 distinct airports and $c$ is the cost of the flight in Swedish kronor in both directions. No pair of $2$ cities is listed twice.\n\nThe next line contains an integer $F$, $(0\\leq F\\leq 250)$, the number of additional flights available. The next $F$ lines contain descriptions of flights in the same format as above. There may be more flights between a pair of cities. You may assume that it is possible to make all the reviews using some of these additional flights.\n\n-----Output-----\nOutput one line with one integer \u2013 the lowest total cost of flight tickets, such that Frida can make all the reviews and return back to Stockholm.\n\n-----Examples-----\nSample Input:\n5 3\n1 2 1000\n2 3 1000\n4 5 500\n2\n1 4 300\n3 5 300\nSample Output:\n3100\nUse Standard Input format\nANSWER:\n"}}