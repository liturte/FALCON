{"2226": {"code": ["2,$n$$m$0,$u$ $w$\\le$n$$n-1, $m-1,$u$ $w$ $w$$1,$m$ $w$ $w$$n$ $n$$n$ $m$ $n$$n$ $m$ $n$ $m$$u$ $", "thethe total weight ofthe(n - 1 \\le\\le 2000$;2$1$1$n$$n - 1$m$ $n-1 $m$ $m$a single integer\u00a0\u2014$n$ isin a singleof the$m$$m$ $n$ $m$$m$ $n$ $n", "($m$$n$ of thevertex $n$ of$m$ of the$n$ of$m$ of thethe$m$ ofthethe$u$ of thethethethe graph is$m$ of thein the given$m$ of theof the given$u$$u$ of$w$ of the given$", "a single integer\u00a0\u2014 the$q$ paths to$n$\\le n,$n$theof)$n$2 2$m$edge withthe sum of theof theedge:$u$1 2 3 107 75 25 587 158 1511 8 1111 11 118 1 1", "$n$a single integer\u00a0\u2014 the sumthethethethe( 1$m$$n$the number ofthe$n$$m$ 2, $u$ $w$ $of the$n$ 2,$u$$u$ $w$$w$ $u$ $w$$u$$m$ 2,", "$2$$u$$v$ $u$ $w$the number of vertices$u$$n$ $m$$u$$v$ $u$ $u$$u$ $u$ $w$$n$ $m$ $w$ $$u$ $w$ $w$$u$ $w$ $w$$u$ $u$ $w", "=($1$ ) \u00a0\u2014 thethe number of vertices inof the path from$n$2$m$ contains aalledge: $1,$v_1, $v_2,$v_2, $v_3, $w$$w$ $w$the$w$ of the$n$ $m$$v$", "the$1$ and $m$ have($q$ contains the$n$ $m$ $n$1$m$ $n$a $n$ $m$$n$ $m$ $n$ $n$a$n$$m$ $n$ $n$$m$ $n$ $n$ $n$ $n$$m$ $n$", "$i$$m$$q$ $n$ is$n$$m$ $n$edgelength $n$$n$ $m$ $u$$w$$v$ $u$ isthe number of$u$ $w$( $n$ -$n$1$m$ $n$$u$ $w$ $w$ $w", "the$n$of$u$ $w$thegraph $n$ $m$ $w$the$v$$n$ $m$$u$ $w$$v$ $u$$n$ $m$ $w$ $w$$m$ $w$ $w$ $w$n$ $n$ $m$ $n$ $n$$"], "prompt": "\nQUESTION:\nYou are given a simple weighted connected undirected graph, consisting of $n$ vertices and $m$ edges.\n\nA path in the graph of length $k$ is a sequence of $k+1$ vertices $v_1, v_2, \\dots, v_{k+1}$ such that for each $i$ $(1 \\le i \\le k)$ the edge $(v_i, v_{i+1})$ is present in the graph. A path from some vertex $v$ also has vertex $v_1=v$. Note that edges and vertices are allowed to be included in the path multiple times.\n\nThe weight of the path is the total weight of edges in it.\n\nFor each $i$ from $1$ to $q$ consider a path from vertex $1$ of length $i$ of the maximum weight. What is the sum of weights of these $q$ paths?\n\nAnswer can be quite large, so print it modulo $10^9+7$.\n\n\n-----Input-----\n\nThe first line contains a three integers $n$, $m$, $q$ ($2 \\le n \\le 2000$; $n - 1 \\le m \\le 2000$; $m \\le q \\le 10^9$)\u00a0\u2014 the number of vertices in the graph, the number of edges in the graph and the number of lengths that should be included in the answer.\n\nEach of the next $m$ lines contains a description of an edge: three integers $v$, $u$, $w$ ($1 \\le v, u \\le n$; $1 \\le w \\le 10^6$)\u00a0\u2014 two vertices $v$ and $u$ are connected by an undirected edge with weight $w$. The graph contains no loops and no multiple edges. It is guaranteed that the given edges form a connected graph.\n\n\n-----Output-----\n\nPrint a single integer\u00a0\u2014 the sum of the weights of the paths from vertex $1$ of maximum weights of lengths $1, 2, \\dots, q$ modulo $10^9+7$.\n\n\n-----Examples-----\nInput\n7 8 25\n1 2 1\n2 3 10\n3 4 2\n1 5 2\n5 6 7\n6 4 15\n5 3 1\n1 7 3\n\nOutput\n4361\n\nInput\n2 1 5\n1 2 4\n\nOutput\n60\n\nInput\n15 15 23\n13 10 12\n11 14 12\n2 15 5\n4 10 8\n10 2 4\n10 7 5\n3 10 1\n5 6 11\n1 13 8\n9 15 4\n4 2 9\n11 15 1\n11 12 14\n10 8 12\n3 6 11\n\nOutput\n3250\n\nInput\n5 10 10000000\n2 4 798\n1 5 824\n5 2 558\n4 1 288\n3 4 1890\n3 1 134\n2 3 1485\n4 5 284\n3 5 1025\n1 2 649\n\nOutput\n768500592\n\n\n\n-----Note-----\n\nHere is the graph for the first example: [Image] \n\nSome maximum weight paths are:   length $1$: edges $(1, 7)$\u00a0\u2014 weight $3$;  length $2$: edges $(1, 2), (2, 3)$\u00a0\u2014 weight $1+10=11$;  length $3$: edges $(1, 5), (5, 6), (6, 4)$\u00a0\u2014 weight $2+7+15=24$;  length $4$: edges $(1, 5), (5, 6), (6, 4), (6, 4)$\u00a0\u2014 weight $2+7+15+15=39$;  $\\dots$ \n\nSo the answer is the sum of $25$ terms: $3+11+24+39+\\dots$\n\nIn the second example the maximum weight paths have weights $4$, $8$, $12$, $16$ and $20$.\nUse Standard Input format\nANSWER:\n"}}