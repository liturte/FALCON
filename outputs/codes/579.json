{"579": {"code": ["::P_i,1,1, 2,-3,5,5,the score is 4- 4 +- 8 +;3,(0, 5,5, 3,(1, 2, 5,6, 6, 7,4,7 +--(0, 5,-1, 5, 5, -", "( 1n =( 1+(= 105-0.- 8.-)1.1.3. Making5, after which the- 8 + 3--2.4. Making3, after which the score= 1..3. Making another moveto Square 2,(1,2", "theA_i/ S_i- 1 \\leqC_ithe- 1 \\leqN\\leq 5000-- 4 + 3 =(1 \\leq\\leq 5000\\leq 5000-5000 -- 1 \\leq\\leqP_i \\leq),C_i \\leqS", "0.- 1 \\leq+ 2 = -1\\leq K \\leq-2,-Making another2,5,is -2.3,2, after whichthe3, after which the5 + 3 =+.Makingathe2, after which the4,5,-8+.", "0\\leq- 1 \\leq N- 1if the(= 0 ; i << 2] =<[ i][].]1[ i] =[ i ]1,=]] = (, 0,] =", "11 +-2 +- 2.1.-;.;+] ) )) ) {[] ) {] ) ;[] ; }] )) {=[ ] )} }} else {] ) ;= (", "the5M_11 \\leq5/ 4/5 / 8thethethe,(1 \\leq\\leq 5,- 4 \\leq 5(1 \\leq\\leq5,5.) {= 1.3. Making5, after which the= -5.5.(1 \\le", "the4thethe- 3 14 + 3 =2.is5,5,5,-8,=.4,5,3, 4,3, 7, 85- 8, 88 + 3, 9,, 5, 5, 9, 9, 10,", "the1,is/0.the=-5.--( 1 -1 --1= -4.1 ---- 1 --1 -1 -1 -1-1 -1 -1 -1-1 -1 -1-1 -1 -1 -1 -1-1 -1 -1 -1", "the\\leq\\leq- 2 \\leq\\leq 5- 1 \\leq2 \\leq 5--4 ++=if we start at2, making1, after2,5, after which the score1,score1,=2,5,6,-(5) = -5.("], "prompt": "\nQUESTION:\nTakahashi will play a game using a piece on an array of squares numbered 1, 2, \\cdots, N. Square i has an integer C_i written on it. Also, he is given a permutation of 1, 2, \\cdots, N: P_1, P_2, \\cdots, P_N.\nNow, he will choose one square and place the piece on that square. Then, he will make the following move some number of times between 1 and K (inclusive):\n - In one move, if the piece is now on Square i (1 \\leq i \\leq N), move it to Square P_i. Here, his score increases by C_{P_i}.\nHelp him by finding the maximum possible score at the end of the game. (The score is 0 at the beginning of the game.)\n\n-----Constraints-----\n - 2 \\leq N \\leq 5000\n - 1 \\leq K \\leq 10^9\n - 1 \\leq P_i \\leq N\n - P_i \\neq i\n - P_1, P_2, \\cdots, P_N are all different.\n - -10^9 \\leq C_i \\leq 10^9\n - All values in input are integers.\n\n-----Input-----\nInput is given from Standard Input in the following format:\nN K\nP_1 P_2 \\cdots P_N\nC_1 C_2 \\cdots C_N\n\n-----Output-----\nPrint the maximum possible score at the end of the game.\n\n-----Sample Input-----\n5 2\n2 4 5 1 3\n3 4 -10 -8 8\n\n-----Sample Output-----\n8\n\nWhen we start at some square of our choice and make at most two moves, we have the following options:\n - If we start at Square 1, making one move sends the piece to Square 2, after which the score is 4. Making another move sends the piece to Square 4, after which the score is 4 + (-8) = -4.\n - If we start at Square 2, making one move sends the piece to Square 4, after which the score is -8. Making another move sends the piece to Square 1, after which the score is -8 + 3 = -5.\n - If we start at Square 3, making one move sends the piece to Square 5, after which the score is 8. Making another move sends the piece to Square 3, after which the score is 8 + (-10) = -2.\n - If we start at Square 4, making one move sends the piece to Square 1, after which the score is 3. Making another move sends the piece to Square 2, after which the score is 3 + 4 = 7.\n - If we start at Square 5, making one move sends the piece to Square 3, after which the score is -10. Making another move sends the piece to Square 5, after which the score is -10 + 8 = -2.\nThe maximum score achieved is 8.\nUse Standard Input format\nANSWER:\n"}}