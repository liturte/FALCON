{"3815": {"code": ["=- 1^{4}- 1^{2} - 1^{0}- 1^{1} 5^{4}\\leq 10^{9},\\leq 10^{9}, 1 \\leq$10^{9},\\leq 10^{9}, 1 \\leq$10^{9}, 1\\leq 10^{9}, 1 \\leq", "\\leq\\leq\\leq$s_{i} =$s_{i}\\leq\\leq 10^{9}, 1 \\leq\\leq n\\leq a\\leq\\leq\\leq$s_{i} = -1$\\leq$s_{i} = 1$\\leq\\leq a\\leq b", "$s_0= -1$ $s_1$ $s_2$s_0 $s_1$ $s_3$ $s_4$ $s_5$\\leq n \\leq 10^{9},$s_1$ $s_6$ $s_7$\\leq k \\leq\\leq n $n$s_2$$s_", "\\sum \\limits_{i=0}^{n} s_{i} a^{n -$s_{i}- 1^{0} -\\sum \\limits_{i=0}^{n} s_{i} a^{n -$s_{i}$s_{i} = 1$$; otherwise $s_{i}= 1$$; otherwise $s_{i}=", "= $s_0 -- 1$ $s_1 - 1$\\sum \\limits_{i=0}^{n} s_{i}$s_0 -$s_1 -\\sum$s_2 \\sum\\sum\\sum \\limits_{i=0}^{n} s_{i} a^{n --- 1^{2}5^{2", "- 1^{2} -$s_{i} =$s_{i} = -1$ $s_{i}$s_0 -= -1$ $s_{i} =$s_1 -\\leq a, b\\leq a,$s_{i} = -1$ $s_{i} =\\leq- 11\\leq\\leq", "\\leq$10^{9}$10^{9} + 9$.\\leq+ 9$ $s_0 =\\leq)1)$10^{9} + 9$ $s_1 =\\leq n -\\leq n - i} b^{i}\\leq- i} a^{n --= -", "\\leq\\leq$s_{i}$s_{i} =\\leq\\leq\\leq n -0 $nn -$n -\\leq\\leq n -$s_{i} =\\leq$k$ $$ $s_{i}$s_{i}+ 9$the secondthe second$s_{", "$1$ $1$ $1$ $1$the secondthe second$k$ $$ $$$s_0 -\\leq n-- 1^{0}\\leq 10^{9}, 1\\leq n $\\leq$1$ $1$ $1$\\leq$1$ $1$ $1$ $1$ $1$", "\\sum \\limits_{i=0}^{n} s_{i} a^{n -\\sum\\sum \\limits_{i=0}^{n} s_{i} a^{n -\\leq\\leq 10^{9}, 1 \\leqa, b,\\leq\\leq 10^{9}, 1 \\leq\\leq 10^{9}, 1"], "prompt": "\nQUESTION:\nYou are given two integers $a$ and $b$. Moreover, you are given a sequence $s_0, s_1, \\dots, s_{n}$. All values in $s$ are integers $1$ or $-1$. It's known that sequence is $k$-periodic and $k$ divides $n+1$. In other words, for each $k \\leq i \\leq n$ it's satisfied that $s_{i} = s_{i - k}$.\n\nFind out the non-negative remainder of division of $\\sum \\limits_{i=0}^{n} s_{i} a^{n - i} b^{i}$ by $10^{9} + 9$.\n\nNote that the modulo is unusual!\n\n\n-----Input-----\n\nThe first line contains four integers $n, a, b$ and $k$ $(1 \\leq n \\leq 10^{9}, 1 \\leq a, b \\leq 10^{9}, 1 \\leq k \\leq 10^{5})$.\n\nThe second line contains a sequence of length $k$ consisting of characters '+' and '-'. \n\nIf the $i$-th character (0-indexed) is '+', then $s_{i} = 1$, otherwise $s_{i} = -1$.\n\nNote that only the first $k$ members of the sequence are given, the rest can be obtained using the periodicity property.\n\n\n-----Output-----\n\nOutput a single integer\u00a0\u2014 value of given expression modulo $10^{9} + 9$.\n\n\n-----Examples-----\nInput\n2 2 3 3\n+-+\n\nOutput\n7\n\nInput\n4 1 5 1\n-\n\nOutput\n999999228\n\n\n\n-----Note-----\n\nIn the first example:\n\n$(\\sum \\limits_{i=0}^{n} s_{i} a^{n - i} b^{i})$ = $2^{2} 3^{0} - 2^{1} 3^{1} + 2^{0} 3^{2}$ = 7\n\nIn the second example:\n\n$(\\sum \\limits_{i=0}^{n} s_{i} a^{n - i} b^{i}) = -1^{4} 5^{0} - 1^{3} 5^{1} - 1^{2} 5^{2} - 1^{1} 5^{3} - 1^{0} 5^{4} = -781 \\equiv 999999228 \\pmod{10^{9} + 9}$.\nUse Standard Input format\nANSWER:\n"}}