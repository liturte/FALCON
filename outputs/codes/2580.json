{"2580": {"code": ["$m$of $n$$u_i$ and $v_i$$n$thethe$m$$m$=2$n$\\ne n$, $u_i$ \\ne$n$ \\ne1$m$ $u_i $u_i$ \\ne$n$ \\le\\n$ $m$ $u_i \\", "(numbers$m$ $m$ $u$$n$$t$ $u_i $v_i $u_itheedge: thethe number ofthenumbersof $n$, $t_i $u_i$i$ -the$i$ $n$$m$ $u_i$, $v_i$ $u_ithe", "of$k$and $m$the givenof$n-1$theof $k$ is givenof $t$thetheof the$m$$u_i$ and $v_i$theofthe$n$athe$n$$k$ is givenof $m$of $n$ nodesof the", "$m$n$$k$the$n$-th$n$, $u_i,$u_i,(1, 2, 3,$i$-thof theof $t$ $i$-this given instead.of the$m$, $u_i, $v_i, $u_i, $v_i$,$", "the$k$the$n$$n$$k$ $n$ $u_i$v_i $u_i $u_i $v_i $u_i$u_i $u_i$n$$m$$m$$k$ $m$$u_i $u_i $v_i $u_i$u_i", "$n$theof anumber oftheof thethe$n$ $m$ $u_i$$v_i$ $u_i$m$ $u_iof $u_i$ $v_i$u_i$ $u_i$ $v_i $u_i$ $v_i$u_i$$v_i $u_", "of $n$number ofin the treeaa$m$$n$ ofof$n$the$n$ of each$n$$i$$u_i$ and $v_i$ is giventheof $t_i $u_iof the$v_i$u_i$ and $v_i$u_i,", "$n$ - 1$i$-ththe$m$$k$thethe $n$ - 11 ]$i$ - 1 ].the$n$ -., $f ) ;$u$ -the number $i$-th$i$-ththeof $u$ and $v_i$$u_i, v_", "number ofof$k$ is given instead.$k$$n$the number oftheof the$t_i$ contains two integer$m$ contains two$u_i $u_i$ and $v_i$v_itheof the$u_i $v_i$ and$u_i $u_i$ $u_iedge:", "the number of$n$thetheis given instead.it containsa$n$$v$, $u_i$, $v_i$ and $u_i$$m$$u_i$, $v_i$,$u_i, $v_i$, $u_i,$v_i, $u_i, $u_i$"], "prompt": "\nQUESTION:\nYou are given a tree that consists of $n$ nodes. You should label each of its $n-1$ edges with an integer in such way that satisfies the following conditions:   each integer must be greater than $0$;  the product of all $n-1$ numbers should be equal to $k$;  the number of $1$-s among all $n-1$ integers must be minimum possible. \n\nLet's define $f(u,v)$ as the sum of the numbers on the simple path from node $u$ to node $v$. Also, let $\\sum\\limits_{i=1}^{n-1} \\sum\\limits_{j=i+1}^n f(i,j)$ be a distribution index of the tree.\n\nFind the maximum possible distribution index you can get. Since answer can be too large, print it modulo $10^9 + 7$.\n\nIn this problem, since the number $k$ can be large, the result of the prime factorization of $k$ is given instead.\n\n\n-----Input-----\n\nThe first line contains one integer $t$ ($1 \\le t \\le 100$)\u00a0\u2014 the number of test cases.\n\nThe first line of each test case contains a single integer $n$ ($2 \\le n \\le 10^5$)\u00a0\u2014 the number of nodes in the tree.\n\nEach of the next $n-1$ lines describes an edge: the $i$-th line contains two integers $u_i$ and $v_i$ ($1 \\le u_i, v_i \\le n$; $u_i \\ne v_i$)\u00a0\u2014 indices of vertices connected by the $i$-th edge.\n\nNext line contains a single integer $m$ ($1 \\le m \\le 6 \\cdot 10^4$)\u00a0\u2014 the number of prime factors of $k$.\n\nNext line contains $m$ prime numbers $p_1, p_2, \\ldots, p_m$ ($2 \\le p_i < 6 \\cdot 10^4$) such that $k = p_1 \\cdot p_2 \\cdot \\ldots \\cdot p_m$.\n\nIt is guaranteed that the sum of $n$ over all test cases doesn't exceed $10^5$, the sum of $m$ over all test cases doesn't exceed $6 \\cdot 10^4$, and the given edges for each test cases form a tree.\n\n\n-----Output-----\n\nPrint the maximum distribution index you can get. Since answer can be too large, print it modulo $10^9+7$.\n\n\n-----Example-----\nInput\n3\n4\n1 2\n2 3\n3 4\n2\n2 2\n4\n3 4\n1 3\n3 2\n2\n3 2\n7\n6 1\n2 3\n4 6\n7 3\n5 1\n3 6\n4\n7 5 13 3\n\nOutput\n17\n18\n286\n\n\n\n-----Note-----\n\n In the first test case, one of the optimal ways is on the following image:\n\n [Image] \n\n In this case, $f(1,2)=1$, $f(1,3)=3$, $f(1,4)=5$, $f(2,3)=2$, $f(2,4)=4$, $f(3,4)=2$, so the sum of these $6$ numbers is $17$.\n\n In the second test case, one of the optimal ways is on the following image:\n\n [Image] \n\n In this case, $f(1,2)=3$, $f(1,3)=1$, $f(1,4)=4$, $f(2,3)=2$, $f(2,4)=5$, $f(3,4)=3$, so the sum of these $6$ numbers is $18$.\nUse Standard Input format\nANSWER:\n"}}