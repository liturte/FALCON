{"3536": {"code": ["ofin thetheof the$n$of the tree.$b$, and$p$, andthe node $p$and thea single integer $b$, andthethethe number ofofthe$n$thenode number in$n$$p$, andof theof the tree,$n$ is the$p", "ofthe$n$.therandomnumber of nodes inthe tree.$b$the number ofa$n$ nodesthe tree.(n$ $n$for each node ofa singlethe node ofthe tree,the node$p$ is thethenode of the$n$the$p$ is thethe parent ofthe node", "in$n$$p$ $0$$b$theisthe number ofnode in thethethe nodethe number of$p$of$p$the$b$$p$ $0$ is the$p$the$n$thethe number of nodesthe number of$n$ nodesand theof the node $p", "0$n$ isthe parent of$n$ is$n$ is thenumber ofin $n$$p$ $0$ is theofthe$p$ is thea singlenode of the$1$ is thenumbernode of theof thenode$n$ $p$ is the$p$ is the parentthein$n$ $", "in aits parent $p$thetheparent $p$$n$the$n$\\le \\!of the$p$$n$ $p$ $0$of theis the$p$$p$ is thethe parent of thethenode of the tree,node$p$ is thenumber of the$b$, and $", "$P{\\cdot }Q^{-1}0a single.) { var= 0 ; for (0 ; i << n ; i; i ++] ) {] )) {] ) ; }] ) )] )(] )1] ) ;( \"Missing) ) ) {] [ 1 ]].) ; }", "$n$ nodes are$b$ $0$thethe probability of $P{\\cdot$1$$p$$1$$2$ $n$ $p$ is$1$the numbernode of the$p$ is the number of$n$$1$ $0$ $p$ is(0,1,2,3,4,5,6,7", "($P{\\cdot }Q^{-1}\\bmod {10^9{+}7}$\\bmod {10^9{+}7}$) $\\frac{P}{Q}$of athe$n$ofnode of the tree.the node of thethe$p$ is the parent$p$ is thethe parent of the$p$ is thethe", "$n$of the$p$node number$b$$p$the probabilityisaone node with athe number ofthe node number $b$the node number$p$ is theparent$p$ is the$p$, thethe$b$ is thethe node numberof$p$ is thenode numberthe node$P", "$b$ $p$ $n$ lines(1, $b$ $p$ $n$ $n$the node of the(1,thethetherandom number,and $n$of the tree,the number ofthe node of thetheinof$P$$p$, $b$ $p$thethethe probability expressed as$"], "prompt": "\nQUESTION:\nConsider a rooted tree with $n$ nodes, numbered $1..n$. Each node will have a fixed integer $b$, and for each, a uniform random real number is chosen in the interval $[0..b]$.\n\nWhat is the probability that the random numbers chosen cause the tree to form a Heap (i.e., the random value in each node is less than the random values in its children)?\n\nThis probability can always be expressed as a rational number $\\frac{P}{Q}$, with $Q{\\not\\equiv }0 \\pmod{10^9{+}7}$. You are to output the probability as $P{\\cdot }Q^{-1} \\bmod {10^9{+}7}$, where $Q^{-1}$ is an integer, which is the multiplicative inverse of $Q$ modulo $10^9{+}7$ ($Q\\! \\cdot \\! Q^{-1}\\! \\equiv \\! 1 \\pmod{10^9{+}7}$). (Note: $P{\\cdot }Q^{-1}\\bmod {10^9{+}7}$ does not depend on whether $P$ and $Q$ are relatively prime, only on their ratio $\\frac{P}{Q}$.)\n\n-----Input-----\nEach test case will begin with a line with a single integer $n$ ($1\\! \\le \\! n\\! \\le \\! 300$), which is the number of nodes in the tree.\n\nEach of the next $n$ lines will contain a pair of space-separated integers $b$ ($1\\! \\le \\! b\\! \\le \\! 10^9$) and $p$ ($0\\! \\le \\! p\\! \\le \\! n$) describing a node of the tree, where $b$ is the fixed integer value in the node and $p$ is the node number of its parent. The nodes are listed in order; node $1$ is first, then node $2$, and so on. A single node will have a parent $p{=}0$. This is the root of the tree.\n\n-----Output-----\nOutput a single integer, which is the probability expressed as $(P{\\cdot }Q^{-1}) \\bmod ({10^9{+}7})$.\n\n-----Examples-----\nSample Input:\n2\n1000000000 0\n1000000000 1\nSample Output:\n500000004\nUse Standard Input format\nANSWER:\n"}}