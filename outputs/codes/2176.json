{"2176": {"code": ["2, 3, 2)]$ is(1,(2,$n$1$$p_1, p_2,\\cdotthe first and second elements$n$ $(2,$n$$n$the$s$ contains$n$ $1$n$$n$$p_1,$p_2,the$", "ofthetwothe$n$thetwo$n$1)the $n$(1,the sequence$s$ becomes$s$$n$$n$ isthe $p$$n$$n$$n$the second elements of $s$of $n$$n$ is$n$$n$ is a", "$a_i$.$a_i$$b_i$$a_i$ and $b_i$the first$b_i $$a_i $$n$ $n$\\cdot 10^5$).$a_i$$n$$n$ $n$$n$$n$$n$$n$$n", "thethein the first$s$$s$ is$n$\\cdot$s$a_i$ and $b_i$the$a_i$the second$b_i$ $1 \\le a_i,$n$$n$ is a$s$$n$ is a good sequence$n$ $s$ is a good", "$i$-th line contains$a_i$ and $b_i$$s$$a_i$ and$n$$i$-th line contains$i$-th line contains$n$\\cdot 10^5$).$n$ $1 \\le$a_i$\\cdot 10^5$).the first $i$-th line contains", "$n$$s$$n$\\cdot 10^5$).the$n$ isthe$n$$n$$n$\\cdot 10^5$).$s_1, s_2, \\dots$p_1,$n$\\cdot 10^5$).$n$ is the number$n$$s$", "$a_i$$n$the sequence$n$ is a good$n$ is a good$n$ is a goodofthe firstthe second elements of$n$$a_i$ $b_i$$a_i$ and $b_i$ $b_i$the first$n$ is a goodof $n$$s$ is$", "$i$-th line containsthe firstand second elements$a_i$the second elements of $a_i$$a_i$$b_i$a_i$ and $b_i$$b_i$\\cdot 10^5$).$a_i$ is$a_i$$b_i$ isthethe$a_i", "theit$n$$s_1, s_2, \\dots,$n$ is the$s_2, s_n$ isthe sequenceis$n$$n$ is a good$n$ is a good$n$ is$s_1,\\dots, s_n$ is$s_2, \\dots$s_3,", "$s$$p_1, s_2, \\dots,$p_n$ is a$p_n$ $s_1,$n$ is a good$s$the$n$ is$s$ $s_2,$s_n$ is$s$ $s_1,$s_2, \\dots,, $p_n$,"], "prompt": "\nQUESTION:\nYou are given a sequence of $n$ pairs of integers: $(a_1, b_1), (a_2, b_2), \\dots , (a_n, b_n)$. This sequence is called bad if it is sorted in non-descending order by first elements or if it is sorted in non-descending order by second elements. Otherwise the sequence is good. There are examples of good and bad sequences:  $s = [(1, 2), (3, 2), (3, 1)]$ is bad because the sequence of first elements is sorted: $[1, 3, 3]$;  $s = [(1, 2), (3, 2), (1, 2)]$ is bad because the sequence of second elements is sorted: $[2, 2, 2]$;  $s = [(1, 1), (2, 2), (3, 3)]$ is bad because both sequences (the sequence of first elements and the sequence of second elements) are sorted;  $s = [(1, 3), (3, 3), (2, 2)]$ is good because neither the sequence of first elements $([1, 3, 2])$ nor the sequence of second elements $([3, 3, 2])$ is sorted. \n\nCalculate the number of permutations of size $n$ such that after applying this permutation to the sequence $s$ it turns into a good sequence. \n\nA permutation $p$ of size $n$ is a sequence $p_1, p_2, \\dots , p_n$ consisting of $n$ distinct integers from $1$ to $n$ ($1 \\le p_i \\le n$). If you apply permutation $p_1, p_2, \\dots , p_n$ to the sequence $s_1, s_2, \\dots , s_n$ you get the sequence $s_{p_1}, s_{p_2}, \\dots , s_{p_n}$. For example, if $s = [(1, 2), (1, 3), (2, 3)]$ and $p = [2, 3, 1]$ then $s$ turns into $[(1, 3), (2, 3), (1, 2)]$.\n\n\n-----Input-----\n\nThe first line contains one integer $n$ ($1 \\le n \\le 3 \\cdot 10^5$).\n\nThe next $n$ lines contains description of sequence $s$. The $i$-th line contains two integers $a_i$ and $b_i$ ($1 \\le a_i, b_i \\le n$) \u2014 the first and second elements of $i$-th pair in the sequence.\n\nThe sequence $s$ may contain equal elements.\n\n\n-----Output-----\n\nPrint the number of permutations of size $n$ such that after applying this permutation to the sequence $s$ it turns into a good sequence. Print the answer modulo $998244353$ (a prime number).\n\n\n-----Examples-----\nInput\n3\n1 1\n2 2\n3 1\n\nOutput\n3\n\nInput\n4\n2 3\n2 2\n2 1\n2 4\n\nOutput\n0\n\nInput\n3\n1 1\n1 1\n2 3\n\nOutput\n4\n\n\n\n-----Note-----\n\nIn first test case there are six permutations of size $3$:   if $p = [1, 2, 3]$, then $s = [(1, 1), (2, 2), (3, 1)]$ \u2014 bad sequence (sorted by first elements);  if $p = [1, 3, 2]$, then $s = [(1, 1), (3, 1), (2, 2)]$ \u2014 bad sequence (sorted by second elements);  if $p = [2, 1, 3]$, then $s = [(2, 2), (1, 1), (3, 1)]$ \u2014 good sequence;  if $p = [2, 3, 1]$, then $s = [(2, 2), (3, 1), (1, 1)]$ \u2014 good sequence;  if $p = [3, 1, 2]$, then $s = [(3, 1), (1, 1), (2, 2)]$ \u2014 bad sequence (sorted by second elements);  if $p = [3, 2, 1]$, then $s = [(3, 1), (2, 2), (1, 1)]$ \u2014 good sequence.\nUse Standard Input format\nANSWER:\n"}}