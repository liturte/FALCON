{"3029": {"code": ["$u_1$ through $u_ N$.a_2, a_1, a_2,, a_2,$a_1, a_2, a_3,a_2, a_1, a_2,a_2,a_1, a_2,a_2, a_3, a_4,of $a_1$and $a", "theof the given treethethethetheto be thethe rooted tree ofthe rooted tree oftheand$v_ N$a_1, a_2, a_k$$v_$v_ N$$u_ N$ and the$u_ N$= $u_[0 ] ;$p_< $v_", "( $N$ ).$N$ $p_$N$ of the treethein the range $[0, 10^6]$.$N$ ofthethe..) ;..) ; }.) ; }; } }..; } })( ) ; }) ; }. length ( )- 1", "the($a_1$ $a_2 $a_ k$ $a_$k$ $a_$k$ $a_= $u_{a_ i}$N$ is thethetheof theof thenumber of$N$( $u_1$the$u_ N$=] );= 1 ; i <if", "number of(the$k$the number ofall$2$k$$u_1$ through $u_the$N$ in the$N$ of the treethe number ofthe$N$ linea1:$N$$N$ line of outputthe$N$$N$ lines of$p_theof the", "$N$the$N$oftheof the tree.thethethe first line ofthe first line of outputwiththe firstthe first linethe first line ofthe first line ofthe$N$thethe$u_1$ throughthe first line of outputof the rooted tree$u_1$ through $u_ N$.$p", "the$v_ N$ is thethethethe parenttheof(thenumber ofthethe rootthethethethe parent$p_the$u_N$ isthe parent ofthe parent of theof the rootthethe parenttheof the root. This isthe$u_ N$ is thethe parent ofthe", ".thefora_1, a_2, a_k$is a sequence of$u_{a_ i} \\le$v_{a_\\lei(\\lei\\lei = 1 $u_{a_] = $u_{a_) ) $u_{a_ i}$$u_{a_ j}$$v_{a_$v_{a", "ofthe tree ofthe rooted tree of(of the$N$$p_$p_=$N$$p_$N$the number of0$.( ) )( ) )= 00 ; i <$N$in( ) )of $N$( ) ;(< $N$; i ++ )", "the treethethetheofthethethe number of$N$ofof$N$ $p_ i $i$the parent $p_the number of$N$$p_of theof the$N$the1ofof $N$ through $u_N$ of thethe number ofthe number of vertices"], "prompt": "\nQUESTION:\nYou are given a rooted tree of $N$ vertices where each vertex $v_1$ through $v_ N$ is labeled with a non-negative integer $u_1$ through $u_ N$. The vertex $v_1$ is the root.\n\nDefine a \u201cjumping path\u201d within the tree to be a sequence $a_1, a_2, \\ldots , a_ k$ of length $k$ where $v_{a_ i}$ is an ancestor of $v_{a_ j}$ for all $1 \\le i < j \\le k$.\n\nCompute two quantities for the given tree:\n - The length $L$ of the longest jumping path where the labels of the vertices are nondecreasing. That is, $u_{a_ i} \\le u_{a_ j}$ for all $1 \\le i < j \\le L$.\n - The number $M$ of jumping paths of length $L$ where the labels of the vertices are nondecreasing. Since this number may be large, give the remainder of $M$ when divided by the prime $11092019$.\n\n-----Input-----\nThe first line of input contains an integer $N$ denoting the number of vertices in the tree ($1 \\leq N \\leq 10^6$).\n\nThis is followed by $N$ lines of input indicating the labels $u_1$ through $u_ N$. Each label is an integer in the range $[0, 10^6]$.\n\nThe remaining $N-1$ lines describe the tree structure. Skipping the root (which has no parent) and starting with $i=2$, line $i$ gives the parent $p_ i < i$ of vertex $v_ i$.\n\n-----Output-----\nPrint a single line of output with two integers separated by a space. The first integer is $L$, and the second integer is $M$ modulo the prime $11092019$.\n\n-----Examples-----\nSample Input 1:\n5\n3\n3\n3\n3\n3\n1\n2\n3\n4\nSample Output 1:\n5 1\n\nSample Input 2:\n5\n4\n3\n2\n1\n0\n1\n2\n3\n4\nSample Output 2:\n1 5\n\nSample Input 3:\n4\n1\n5\n3\n6\n1\n2\n3\nSample Output 3:\n3 2\nUse Standard Input format\nANSWER:\n"}}