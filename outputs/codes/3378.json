{"3378": {"code": ["in thein that exact order,of(toof the$a_i$a_i \\not= a_{i+1}$).of the airfare$a_i$a_i \\not= a_{i+1}$).$a_i \\not=of the$a_{i+1}$.the firstof theifthethethe", ". The firstof thethey arearethey arethethese arein that exact order,havingthese concerts inthethe number of concerts in(a_1 \\ne n,(a_2\\le n,$d$ofconjugate.the firstnumber of concretstourthose concrets.", "theof thein that exact order,theof\\dots,and $a_{i+1}$ \u2013the number ofconcerts inthe$a_2,$a_2,$a_i\\not= a_{i+1}$). Theoneofto beof theto beto be usedthetoa if he has", "thein that exact orderthosebeingof theisof theand the number of concerts\\le n, d \\le 300000$).\\lenumber of concerts\\le n, d \\le 300000$.the$a_1,a_2, \\dots, a_a_ d$ in that exactin thatthe number ofthenumber", "twoin that exact order..tourin that exact order,the\\le n,the number ofconcerts in the same citytheytour inthein that exactconsecutive concerts inthethe number of$a_itheconcrets in the samethe number of concretsthe number ofthe\\le n, d \\", "of$a_1concerts $a_2, \\dots,ofin that exact order,the number of concertsin thatififthenthe number ofthe$a_1$a_2, \\dots\\le 300000$)the numberthe number ofthe number of concertsin that exact order,the number of concertsthenumber", "and $a_i \\thesein the sametourin theconjugate ofconjugateinin the samein the samethese concretsthe number of concrets inconjugate ofin thecities in the same$a_iin the same$a_iin the same city.the$a_iin", "in that exact order,one of thenumbered withconsecutive concerts inofto$a_ iofof theconcrets in thatthatthe number of concertsone of the citiesnumbered withconcrets in the same city$a_1, a_2,numbered withthenumbered withthe numberin that exact order.", "the number ofthea_1, a_2)ofofin$a$ toaandthe$d$ isthetwotheconsent in the same\\le n, dthe number ofconcerts. Thethe number of concertsin thein the$a_1, a_2,\\lethenumber of", "the number of concertsand)the firstthe first ticket of$a$ to $b$toof $a$ ticket tofrom the$a$ to $b$(a_2 =) { $n$ =) ; $d$$n$$d$.($a_1,.$a_2,$a_1, $"], "prompt": "\nQUESTION:\nIvan is planning a large European tour with his jazz band. There are a total of $n$ cities in Europe, numbered with integers $1$ through $n$. Ivan is planning $d$ concerts in cities $a_1, a_2, \\dots , a_ d$ in that exact order, never having two consecutive concerts in the same city ($a_ i \\not= a_{i+1}$), possibly visiting some of the cities many times and, finally, ending the tour in the same city where it begun ($a_1 = a_ d$).\n\nIvan always takes a direct flight between cities $a_ i$ and $a_{i+1}$. However, he is trying to be smart with his ticket purchases in order to save money. As you may know, airlines price tickets based on supply and demand and, for example, it may be possible that one-way tickets are more expensive than round trip tickets between same cities. Generally, there are two kinds of tickets available for purchase:\n - One-way ticket from the origin city $a$ to destination city $b$ can be used to fly from $a$ to $b$ once (but not in the opposite direction).\n - Round trip ticket from the origin city $a$ to destination city $b$ can be used to fly once from $a$ to $b$, and once from $b$ to $a$. The return segment (from $b$ to $a$) does not need to be used. However, the segments have to be flown in order \u2013 it is not allowed for Ivan to use the return segment of $a$ ticket to fly from $b$ to a unless he has used the first segment of that ticket to fly from $a$ to $b$ before.\n\nYou are given a list of available airfares, find the least amount of money Ivan needs to spend on tickets to be able to complete his journey. Ivan can purchase an arbitrary number of tickets for each airfare. Once again, Ivan needs to take a direct flight from $a_ i$ to $a_{i+1}$ for every $i = 1, 2, \\dots , d - 1$. You may assume that is possible to complete the journey using the airfares.\n\n-----Input-----\nThe first line contains two integers $n$ and $d$ ($2 \\le n, d \\le 300000$) \u2013 the number of cities in Europe and the number of concerts. The following line contains integers $a_1, a_2, \\dots , a_ d$ ($1 \\le ai \\le n, ai \\not= a_{i+1}, a_1 = a_ d$) \u2013 the planned tour schedule.\n\nThe following line contains an integer $m$ ($3 \\le m \\le 300000$) \u2013 the number of airfares. The $k$-th of the following $m$ lines contains four tokens $s_ k$, $d_ k$, $t_ k$, $p_ k$, describing the $k$-th airfare as follows:\n - $s_ k$ and $d_ k$ ($1 \\le s_ k, d_ k \\le n, s_ k \\not= d_ k$) are the origin and the destination city respectively,\n - $t_ k$ is an uppercase letter \u201cO\u201d or \u201cR\u201d denoting a one-way or round trip ticket respectively,\n - $p_ k$ ($1 \\le pk \\le 10^9$) is the ticket price, an integer.\n\n-----Output-----\nOutput the least amount of money necessary to purchase tickets that allow Ivan to complete the planned tour.\n\n-----Examples-----\nSample Input:\n2 5\n1 2 1 2 1\n4\n1 2 R 6\n1 2 O 3\n2 1 O 3\n1 2 R 5\nSample Output:\n10\nUse Standard Input format\nANSWER:\n"}}