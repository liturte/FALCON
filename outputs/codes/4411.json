{"4411": {"code": ["for$m$ andand $m$thethethethe$m$thethosethemthethetheof the$m$, $p_1,of thethethetheisof thethethethethe first line of the$n$ of thethe first line of theof thethe first line of the", "$n$of the$l_i; r_i$ $l_ir_i$ ($1 \\le$l_i; r_i$ $r_i$$l_i \\le\\le\\le n$\\le n$$m$ (1 \\le\\le n$$p_1, $p_2, \\dots, p_m$ ($", "and $l_i; r_i$the$l_i; r_i$the $i$-thisto$n$the $k$$l_i; r_i$ $r_i$$r_i$ $l_i$thetwo$p_1,$p_2, \\dots,$p_1,$p", "$n$$l_i; r_i$2 \\cdot 10^5$)in the first linethe second line isthethe.\\cdot\\cdot 10^5$)an$ and $p_1,\\cdot 10^5$)$p_i$,\\cdot 10^5$)\\cdot 10^5$)", "the$n$ and $i$$l_i; r_i$n$). The$n$the\\le n$of$m$$p_1,p_2,$p_1 \\le n$= $p_1\\le\\le p_i $$p_1 \\le n$\\len$=\\le", "allthethethethethethe2 \\cdot 10^5$theof the1of$m$the $n$ linesthethe first linethe first line of thein$n$the first line containsthethethe$m$ in$n$the first line of the", "$k$ $l_i$ $r_i$$k$\\le r_i$the$i$-th$n$$m$thenumber ofthe$m$ ($1 \\le\\le n$of$i$-th$n$ $i$$n$ $k$ $n$ $n$$k$ $n$ $k", "the$n$$k$theline contains two$i$ $$l_i $\\le$k$\\le 2 \\cdot 10^5$$m$ $m$ $n$$m$ $n$ $n$\\le n$\\le$m$ $n$ $m$ $n$$n$ \\le\\le n$", "$l_i; r_i$ is $[l_i;r_i$2 \\cdot 10^5$the$l_i; r_i$2 \\cdot 10^5$ $n$$k$ $l_i\\le$m$\\cdot 10^5$ $n$$k$$k$$r_i$ $n$", "$n$$k$in the first linethe$m$$i$-th$m$ (\\le n $$m$$n$the$n$theofand thethe$n$ segments areby theistothe $i$-ththe$k$$l_i; r_i$ $r_i"], "prompt": "\nQUESTION:\nThe only difference between easy and hard versions is constraints.\n\nYou are given $n$ segments on the coordinate axis $OX$. Segments can intersect, lie inside each other and even coincide. The $i$-th segment is $[l_i; r_i]$ ($l_i \\le r_i$) and it covers all integer points $j$ such that $l_i \\le j \\le r_i$.\n\nThe integer point is called bad if it is covered by strictly more than $k$ segments.\n\nYour task is to remove the minimum number of segments so that there are no bad points at all.\n\n\n-----Input-----\n\nThe first line of the input contains two integers $n$ and $k$ ($1 \\le k \\le n \\le 2 \\cdot 10^5$) \u2014 the number of segments and the maximum number of segments by which each integer point can be covered.\n\nThe next $n$ lines contain segments. The $i$-th line contains two integers $l_i$ and $r_i$ ($1 \\le l_i \\le r_i \\le 2 \\cdot 10^5$) \u2014 the endpoints of the $i$-th segment.\n\n\n-----Output-----\n\nIn the first line print one integer $m$ ($0 \\le m \\le n$) \u2014 the minimum number of segments you need to remove so that there are no bad points.\n\nIn the second line print $m$ distinct integers $p_1, p_2, \\dots, p_m$ ($1 \\le p_i \\le n$) \u2014 indices of segments you remove in any order. If there are multiple answers, you can print any of them.\n\n\n-----Examples-----\nInput\n7 2\n11 11\n9 11\n7 8\n8 9\n7 8\n9 11\n7 9\n\nOutput\n3\n4 6 7 \n\nInput\n5 1\n29 30\n30 30\n29 29\n28 30\n30 30\n\nOutput\n3\n1 4 5 \n\nInput\n6 1\n2 3\n3 3\n2 3\n2 2\n2 3\n2 3\n\nOutput\n4\n1 3 5 6\nUse Standard Input format\nANSWER:\n"}}