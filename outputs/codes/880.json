{"880": {"code": ["the$p$ of length= $n$$1 \\leq n \\leq 10^6$the number of$n$ having sum $\\frac{n(n+1)}$n$ having sum $\\frac{n(n+1)}{2}$.$n$ having sum $\\frac{n(n+1)}{2}$,$n$ having sum $\\frac{n", "the$9$a single integer\u00a0$3, 2, 3]$, $[3, 1,2, 3]$, $[3, 2,2, 3]$, $[3,2, 3]$, $[2, 3, 1]$,$[3,3]$, $[3, 1,$[3, 1, 2]$, $[", "$n$$3$ \u00a0$n$the$2$of length $3$$1, 2, 3]$, $[2,2, 3]$, $[3,2, 3]$,3, 2]$, $[1, 2,$[2,2, 3]$, $[3,2]$, $[1,", "$n$ \u00a0theof the= 2 $n$$n$the number of subarrays ofof$n$ \u00a0of thenumber of$n$$n$$n$$n$of theofof$n$thethey are:$n$$n$ $n$$n$ $n$ $n", "2,2, 3]$, $[3,2, 3]$,$[3, 2, 3]$, $[3,2, 3]$,$[3, 1,$[3, 1,1, 2]$, $[2,3]$, $[3, 1, 3]$,$[3,2, 3]$, $[3", "the first sample of$3$ isthe number ofthethe3, 2, 3]$,$[3,3]$, $[2,$[3,2, 3]$, $[3,$[3,2, 3]$,$[3, 1, 3]$, $[3, 1,$[3, 1,2,$", "$n$ are$n$the$n$ are$1 \\leq n$n$$n$$n$(n+1)istheof$n$, $p_i, $p_j) are$n$, $n,$n$, $n, $n, $n$$n,$n$, $n, $", "of $n$$3$, $[2, 3,$3$, $[1,$[3, 2,2]$, $[2, 3, 2]$, $[3,2, 3]$,the$n$$3$, $[2, 2,$[1, 2, 3]$,$3$, $[2, 3, 2", "$3$the first sample, there is2$$3$,thethe first sample, there$3$,$3$, $3$, $3$, $3$,$3$, $3$, $3$, $3$,$3$,3]$, $[3, 1,$3$, $3,$3$, $[3", "$2$$3$$3$ $[3,$3, 2, 3]$, $[3,$[3, 1, 3]$, $[3,2, 3]$,$[2,1]$,2, 3]$, $[1,2, 3]$, $[1, 2,$[1, 3,$[3,"], "prompt": "\nQUESTION:\nLet $n$ be an integer. Consider all permutations on integers $1$ to $n$ in lexicographic order, and concatenate them into one big sequence $p$. For example, if $n = 3$, then $p = [1, 2, 3, 1, 3, 2, 2, 1, 3, 2, 3, 1, 3, 1, 2, 3, 2, 1]$. The length of this sequence will be $n \\cdot n!$.\n\nLet $1 \\leq i \\leq j \\leq n \\cdot n!$ be a pair of indices. We call the sequence $(p_i, p_{i+1}, \\dots, p_{j-1}, p_j)$ a subarray of $p$. Its length is defined as the number of its elements, i.e., $j - i + 1$. Its sum is the sum of all its elements, i.e., $\\sum_{k=i}^j p_k$. \n\nYou are given $n$. Find the number of subarrays of $p$ of length $n$ having sum $\\frac{n(n+1)}{2}$. Since this number may be large, output it modulo $998244353$ (a prime number). \n\n\n-----Input-----\n\nThe only line contains one integer $n$\u00a0($1 \\leq n \\leq 10^6$), as described in the problem statement.\n\n\n-----Output-----\n\nOutput a single integer\u00a0\u2014 the number of subarrays of length $n$ having sum $\\frac{n(n+1)}{2}$, modulo $998244353$.\n\n\n-----Examples-----\nInput\n3\n\nOutput\n9\n\nInput\n4\n\nOutput\n56\n\nInput\n10\n\nOutput\n30052700\n\n\n\n-----Note-----\n\nIn the first sample, there are $16$ subarrays of length $3$. In order of appearance, they are:\n\n$[1, 2, 3]$, $[2, 3, 1]$, $[3, 1, 3]$, $[1, 3, 2]$, $[3, 2, 2]$, $[2, 2, 1]$, $[2, 1, 3]$, $[1, 3, 2]$, $[3, 2, 3]$, $[2, 3, 1]$, $[3, 1, 3]$, $[1, 3, 1]$, $[3, 1, 2]$, $[1, 2, 3]$, $[2, 3, 2]$, $[3, 2, 1]$. \n\nTheir sums are $6$, $6$, $7$, $6$, $7$, $5$, $6$, $6$, $8$, $6$, $7$, $5$, $6$, $6$, $7$, $6$. As $\\frac{n(n+1)}{2} = 6$, the answer is $9$.\nUse Standard Input format\nANSWER:\n"}}