{"1172": {"code": ["T_iT_jT_kAABCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC", "the+the number ofA or B or CT = ATT = AT =AA =A = BBA =B = CA =B =B = CC =C =A =A = AA =A = AAA = BA = B ; A", "the3 \u2264is3 \u2264T = AT =BT = C)T = AAAAAAAAAAAA =AB = CA = CB = CA = C", "T_iT_j2 +A or B orS =T_i = BT_j +T_kT_iT_j + T_kT_i =T_k =T_jT_k = T_kT_iT_kT_kT_k )T_k =T_kT_i", "ofTtheTtheisof the=) ;theofTtheT_jT_kT_i = B\nT_jT_k = C\nA?C= B=T_k ==T_k ==T_i ==T_j == T_k )T_k == 0 ) {T_i", "=++A or B or C:+ 1 + 1 ++A+ 1 ++ 1 ++++ 1 + 1 ++++ 0+ 0 + 0++++ 1+ 2 ++ 1 +++2 + 1 +", "theof thethe-=.=-A, B, C or?the0-AAAAAC:AAC:AAC: 0AAC: 0AAC: 1AAC: 1AACC: 0AACC:AAC: 0AAC:AAC: 0AAC: 1 AAC: 2", "-T_i =+.theT_j < BT_k =T_iT_j <T_k < BT_k <T_k <T_k )T_kT_kT_kT_kT_j < BT_k < T_iT_j < T_kT_kT", "1 +.A9 +AAAAABCAACCAACC : 0AACC :ABAC: 1AAC: 1AACC: 2AACC:AACC: 0AACC: 1AACC: 2AACC: 2AACC: 2AACC:AACC: 2", "T =+ 7T =AT =8a\"A\" in SA \"B\" is\"C\" in S\"A\" =AA\" =\"A\" = AB \"C\"A\"A\"A\" = A\"AA\" = AA\"A\" =\"A\"\"B\" = AA\" ="], "prompt": "\nQUESTION:\nThe ABC number of a string T is the number of triples of integers (i, j, k) that satisfy all of the following conditions:\n - 1 \u2264 i < j < k \u2264 |T| (|T| is the length of T.)\n - T_i = A (T_i is the i-th character of T from the beginning.)\n - T_j = B\n - T_k = C\nFor example, when T = ABCBC, there are three triples of integers (i, j, k) that satisfy the conditions: (1, 2, 3), (1, 2, 5), (1, 4, 5). Thus, the ABC number of T is 3.\nYou are given a string S. Each character of S is A, B, C or ?.\nLet Q be the number of occurrences of ? in S. We can make 3^Q strings by replacing each occurrence of ? in S with A, B or C. Find the sum of the ABC numbers of all these strings.\nThis sum can be extremely large, so print the sum modulo 10^9 + 7.\n\n-----Constraints-----\n - 3 \u2264 |S| \u2264 10^5\n - Each character of S is A, B, C or ?.\n\n-----Input-----\nInput is given from Standard Input in the following format:\nS\n\n-----Output-----\nPrint the sum of the ABC numbers of all the 3^Q strings, modulo 10^9 + 7.\n\n-----Sample Input-----\nA??C\n\n-----Sample Output-----\n8\n\nIn this case, Q = 2, and we can make 3^Q = 9 strings by by replacing each occurrence of ? with A, B or C. The ABC number of each of these strings is as follows:\n - AAAC: 0\n - AABC: 2\n - AACC: 0\n - ABAC: 1\n - ABBC: 2\n - ABCC: 2\n - ACAC: 0\n - ACBC: 1\n - ACCC: 0\nThe sum of these is 0 + 2 + 0 + 1 + 2 + 2 + 0 + 1 + 0 = 8, so we print 8 modulo 10^9 + 7, that is, 8.\nUse Standard Input format\nANSWER:\n"}}