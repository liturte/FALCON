{"1984": {"code": ["thethelevel A.in thelevel B. Thislevel A. This operation requireslevel A.levels A.y_1,y_2, x_{k}, y_{k}oflevely_{k}==0;\u00a01 \u2264k=y_1, x_{k}, y_{k}, x_{k},y_{k},", "beofnumber of=n\u00b7m, k, w \u2264 1000m\u00b7n,k\u00b7n\u00b7m, w \u00a01n\u00b7m, n\u00b7m\u00b7m,forlevel== 0, that means that= 1m_1, x_2, y_2,...,x_{k}, y_{k},...,", "thelevel Bof theinlevels A and B.(y_k, x_{k}, y_{k},levels A and B areof theof(level B.the number ofof theof thelevel B.thenumber ofthelevel B. Ity_{k}, x_{k}, y_{k},inthethe number ofof", "of alevel Alevel Binthe. Theofofthelevel A is. The number ofof alevel B isthe number ofoflevel A.oflevelthatthebe transferredandthetoof a level B.the number of cells of", "ofthelevela network.inlevel Alevel Boftheof thearetoto transferreda network.thelevels.thethea network,you cantotransferreda network, andlevel B, and w isthe network.. log ( 'level A:", "byofthelevel B. Thethenumber ofinthethe number ofof thethethelevel A. The number oflevel B is thetothebe transferredlevel A.the number oflevel B. The number oflevel A. The numberof theof thetheof thethelevel B. Thisthe number oflevel B.", "(ofof the level A.thelevel.the number ofthetheof thelevel B.isthethe number ofof thelevel B. Itthetheof thethe number ofthethe number ofthe number ofof theof theis the number of the", "of thethein thelevel Bfor a levellevel B. Thislevel B(2 \u2264the number ofof a previously transferredof thethen\u00b7m bytes.of theathe number oftheof thelevel Bifbe transferredthe number oftheof theof theof the level B. Itiflevel", "the levels arein thelevels A, B, and w.[Image]the....,..() ; }) ; }.) ; }( ) ;( )) ;)( ) ; }=) ) ; }. log ( \"Error:", "thethethe=level(n\u00b7m m \u00b7level A. Itthe difference betweenlevel A.y_{i} isthethe number ofofisof thelevel A. Itnumber of levels A. Itisnumber of levelsand(n\u00b7m m\u00b7m m\u00b7m\u00b7my_{k}, x_{k},"], "prompt": "\nQUESTION:\nDuring the loading of the game \"Dungeons and Candies\" you are required to get descriptions of k levels from the server. Each description is a map of an n \u00d7 m checkered rectangular field. Some cells of the field contain candies (each cell has at most one candy). An empty cell is denoted as \".\" on the map, but if a cell has a candy, it is denoted as a letter of the English alphabet. A level may contain identical candies, in this case the letters in the corresponding cells of the map will be the same.\n\n [Image] \n\nWhen you transmit information via a network, you want to minimize traffic \u2014 the total size of the transferred data. The levels can be transmitted in any order. There are two ways to transmit the current level A:\n\n  You can transmit the whole level A. Then you need to transmit n\u00b7m bytes via the network.  You can transmit the difference between level A and some previously transmitted level B (if it exists); this operation requires to transmit d_{A}, B\u00b7w bytes, where d_{A}, B is the number of cells of the field that are different for A and B, and w is a constant. Note, that you should compare only the corresponding cells of levels A and B to calculate d_{A}, B. You cannot transform the maps of levels, i.e. rotate or shift them relatively to each other. \n\nYour task is to find a way to transfer all the k levels and minimize the traffic.\n\n\n-----Input-----\n\nThe first line contains four integers n, m, k, w (1 \u2264 n, m \u2264 10;\u00a01 \u2264 k, w \u2264 1000). Then follows the description of k levels. Each level is described by n lines, each line contains m characters. Each character is either a letter of the English alphabet or a dot (\".\"). Please note that the case of the letters matters.\n\n\n-----Output-----\n\nIn the first line print the required minimum number of transferred bytes.\n\nThen print k pairs of integers x_1, y_1, x_2, y_2, ..., x_{k}, y_{k}, describing the way to transfer levels. Pair x_{i}, y_{i} means that level x_{i} needs to be transferred by way y_{i}. If y_{i} equals 0, that means that the level must be transferred using the first way, otherwise y_{i} must be equal to the number of a previously transferred level. It means that you will transfer the difference between levels y_{i} and x_{i} to transfer level x_{i}. Print the pairs in the order of transferring levels. The levels are numbered 1 through k in the order they follow in the input.\n\nIf there are multiple optimal solutions, you can print any of them.\n\n\n-----Examples-----\nInput\n2 3 3 2\nA.A\n...\nA.a\n..C\nX.Y\n...\n\nOutput\n14\n1 0\n2 1\n3 1\n\nInput\n1 1 4 1\nA\n.\nB\n.\n\nOutput\n3\n1 0\n2 0\n4 2\n3 0\n\nInput\n1 3 5 2\nABA\nBBB\nBBA\nBAB\nABB\n\nOutput\n11\n1 0\n3 1\n2 3\n4 2\n5 1\nUse Standard Input format\nANSWER:\n"}}