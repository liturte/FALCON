{"4510": {"code": ["the$m$thethe. \nObtainedConversations $n$of thetheofthethemessage. \nObtainedConversationstheconversations.messages and the number ofconversationsthe conversationsand thenumber of conversationsthethe $m$-th messagethese conversations.of the conversationsthethe conversationsthe $n", "$i$-th messagethe $n$ messagesconversations with thethetheyou cantheand theconversationsto thethetheand thethetheto the $i$-th message.the$m$ ($1\\lethe number of conversationsthethe$n$$k$ is thethein the screen.$n", ")the number ofconversations shown after receivingthe screen.the$n$one\\leand the$n$in thethe conversations youthemessage in thethe(suddenly) is displayedthethethe conversationsthe number ofand $k$thetheof themessages.$n$ messages. \u2014 the number", "the friends. theconversations on the screentheconversations displayed on theis thethethe$i$-th message.theis the$i$-th message.the conversationsthemessage,thethein thetheconversations shownthe userthe conversations youthethe conversations inthe screen.the number of conversations", "the screen$n$ messages andthethethe$n$ messagesthenumber of conversationsthe first linethe first line of thethethe firstthethe number ofconversations shown after receivingconversations showninmessages.the firstthe first linethe first linethe first line of thethe secondthe firstthe secondthe first line of the", "of the\\le none$m$the conversations(in the orderto thethe screen isthe first$n$ isa single messagethe$id_i$ is thethe$n$ is thein thethetheof the conversationsthethethethethe conversations $m$ is theof thethe conversations $k$", "theconversationsthe first$n$number ofthe$m$the number of conversationsthe numberthetheconversationsthethethe conversations shown after receivingconversations. \u2014 the numbermessages. \u2014 thethe number of conversationsthe$n$ messages. \u2014the number of conversationsthethebe displayed", "the(n, k)$$m$thenumber of conversationsin thethis$m$the number of conversationsthe number of conversationstheisthe firstin thethethe$m$$n$messages.conversations with theconversations of the screenthetheconversations of thethethe screen, when the $id_i$", ".for thetheconversations of the screenthe:,,,(id_i,, id_1, id_2,\\cdot 10^5)$ \u2014 thethemessagetheand the number of conversations$n$the conversationsthe, k, k )(n, k)$the number of conversationsis displayed on", "the\\\\lethe$n$ messages, thethemessage isthe$m$the number of conversationsto the. \nthethe input contains two$n$ integersof the conversations thatthe $i$-th messagewith theyou cananof theof thethetheof the$m$ ($1 \\le m \\le"], "prompt": "\nQUESTION:\nThe only difference between easy and hard versions are constraints on $n$ and $k$.\n\nYou are messaging in one of the popular social networks via your smartphone. Your smartphone can show at most $k$ most recent conversations with your friends. Initially, the screen is empty (i.e. the number of displayed conversations equals $0$).\n\nEach conversation is between you and some of your friends. There is at most one conversation with any of your friends. So each conversation is uniquely defined by your friend.\n\nYou (suddenly!) have the ability to see the future. You know that during the day you will receive $n$ messages, the $i$-th message will be received from the friend with ID $id_i$ ($1 \\le id_i \\le 10^9$).\n\nIf you receive a message from $id_i$ in the conversation which is currently displayed on the smartphone then nothing happens: the conversations of the screen do not change and do not change their order, you read the message and continue waiting for new messages.\n\nOtherwise (i.e. if there is no conversation with $id_i$ on the screen):\n\n  Firstly, if the number of conversations displayed on the screen is $k$, the last conversation (which has the position $k$) is removed from the screen.  Now the number of conversations on the screen is guaranteed to be less than $k$ and the conversation with the friend $id_i$ is not displayed on the screen.  The conversation with the friend $id_i$ appears on the first (the topmost) position on the screen and all the other displayed conversations are shifted one position down. \n\nYour task is to find the list of conversations (in the order they are displayed on the screen) after processing all $n$ messages.\n\n\n-----Input-----\n\nThe first line of the input contains two integers $n$ and $k$ ($1 \\le n, k \\le 2 \\cdot 10^5)$ \u2014 the number of messages and the number of conversations your smartphone can show.\n\nThe second line of the input contains $n$ integers $id_1, id_2, \\dots, id_n$ ($1 \\le id_i \\le 10^9$), where $id_i$ is the ID of the friend which sends you the $i$-th message.\n\n\n-----Output-----\n\nIn the first line of the output print one integer $m$ ($1 \\le m \\le min(n, k)$) \u2014 the number of conversations shown after receiving all $n$ messages.\n\nIn the second line print $m$ integers $ids_1, ids_2, \\dots, ids_m$, where $ids_i$ should be equal to the ID of the friend corresponding to the conversation displayed on the position $i$ after receiving all $n$ messages.\n\n\n-----Examples-----\nInput\n7 2\n1 2 3 2 1 3 2\n\nOutput\n2\n2 1 \n\nInput\n10 4\n2 3 3 1 1 2 1 2 3 3\n\nOutput\n3\n1 3 2 \n\n\n\n-----Note-----\n\nIn the first example the list of conversations will change in the following way (in order from the first to last message):\n\n  $[]$;  $[1]$;  $[2, 1]$;  $[3, 2]$;  $[3, 2]$;  $[1, 3]$;  $[1, 3]$;  $[2, 1]$. \n\nIn the second example the list of conversations will change in the following way:\n\n  $[]$;  $[2]$;  $[3, 2]$;  $[3, 2]$;  $[1, 3, 2]$;  and then the list will not change till the end.\nUse Standard Input format\nANSWER:\n"}}