{"1793": {"code": ["from", "from", "import", "from", "import"], "prompt": "\nQUESTION:\nYou are given a rooted tree on $n$ vertices, its root is the vertex number $1$. The $i$-th vertex contains a number $w_i$. Split it into the minimum possible number of vertical paths in such a way that each path contains no more than $L$ vertices and the sum of integers $w_i$ on each path does not exceed $S$. Each vertex should belong to exactly one path.\n\nA vertical path is a sequence of vertices $v_1, v_2, \\ldots, v_k$ where $v_i$ ($i \\ge 2$) is the parent of $v_{i - 1}$.\n\n\n-----Input-----\n\nThe first line contains three integers $n$, $L$, $S$ ($1 \\le n \\le 10^5$, $1 \\le L \\le 10^5$, $1 \\le S \\le 10^{18}$)\u00a0\u2014 the number of vertices, the maximum number of vertices in one path and the maximum sum in one path.\n\nThe second line contains $n$ integers $w_1, w_2, \\ldots, w_n$ ($1 \\le w_i \\le 10^9$)\u00a0\u2014 the numbers in the vertices of the tree.\n\nThe third line contains $n - 1$ integers $p_2, \\ldots, p_n$ ($1 \\le p_i < i$), where $p_i$ is the parent of the $i$-th vertex in the tree.\n\n\n-----Output-----\n\nOutput one number \u00a0\u2014 the minimum number of vertical paths. If it is impossible to split the tree, output $-1$.\n\n\n-----Examples-----\nInput\n3 1 3\n1 2 3\n1 1\n\nOutput\n3\nInput\n3 3 6\n1 2 3\n1 1\n\nOutput\n2\nInput\n1 1 10000\n10001\n\nOutput\n-1\n\n\n-----Note-----\n\nIn the first sample the tree is split into $\\{1\\},\\ \\{2\\},\\ \\{3\\}$.\n\nIn the second sample the tree is split into $\\{1,\\ 2\\},\\ \\{3\\}$ or $\\{1,\\ 3\\},\\ \\{2\\}$.\n\nIn the third sample it is impossible to split the tree.\nPlease provide the solution as pure code only, without explanations or comments.\n\nANSWER:\n```python\n"}}