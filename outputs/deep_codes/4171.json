{"4171": {"code": ["import heapq\n\ndef min_operations(n, k, a):\n    heap = [-e for e in a]\n    heapq.heapify(heap)\n    operations = 0\n    while -heap[0] < k:\n        operations += 1\n        x = -heapq.heapp", "import heapq\n\nn, k = map(int, input().split())\na = list(map(int, input().split()))\n\n# Using a heap to keep track of the maximum element in the array\nheap = [-i for i in a]\nheapq.heapify(heap)\n\noperations", "import heapq\n\nn, k = map(int, input().split())\na = list(map(int, input().split()))\n\na = [-x for x in a]\nheapq.heapify(a)\n\nops = 0\nwhile -a[0] < k:\n    x = -he", "import heapq\n\ndef solve(n, k, a):\n    h = []\n    for num in a:\n        heapq.heappush(h, num)\n    cnt = 0\n    while h[0] < k:\n        smallest = heapq.heappop(h)\n        heapq.", "import heapq\n\ndef solve(n, k, a):\n    a = [-e for e in a]\n    heapq.heapify(a)\n    cnt = 0\n    while True:\n        x = -heapq.heappop(a)\n        if x == 0:\n            return c"], "prompt": "\nQUESTION:\nThe only difference between easy and hard versions is the number of elements in the array.\n\nYou are given an array $a$ consisting of $n$ integers. In one move you can choose any $a_i$ and divide it by $2$ rounding down (in other words, in one move you can set $a_i := \\lfloor\\frac{a_i}{2}\\rfloor$).\n\nYou can perform such an operation any (possibly, zero) number of times with any $a_i$.\n\nYour task is to calculate the minimum possible number of operations required to obtain at least $k$ equal numbers in the array.\n\nDon't forget that it is possible to have $a_i = 0$ after some operations, thus the answer always exists.\n\n\n-----Input-----\n\nThe first line of the input contains two integers $n$ and $k$ ($1 \\le k \\le n \\le 2 \\cdot 10^5$) \u2014 the number of elements in the array and the number of equal numbers required.\n\nThe second line of the input contains $n$ integers $a_1, a_2, \\dots, a_n$ ($1 \\le a_i \\le 2 \\cdot 10^5$), where $a_i$ is the $i$-th element of $a$.\n\n\n-----Output-----\n\nPrint one integer \u2014 the minimum possible number of operations required to obtain at least $k$ equal numbers in the array.\n\n\n-----Examples-----\nInput\n5 3\n1 2 2 4 5\n\nOutput\n1\n\nInput\n5 3\n1 2 3 4 5\n\nOutput\n2\n\nInput\n5 3\n1 2 3 3 3\n\nOutput\n0\nPlease provide the solution as pure code only, without explanations or comments.\n\nANSWER:\n```python\n"}}