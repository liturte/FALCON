{"2811": {"code": ["QUESTION:\nYou are given a rooted tree with $n$ nodes. The nodes are numbered $1..n$. The root is node $1$, and $m$ of the nodes are colored red, the rest are black.\n\nYou would like to choose a subset of nodes such that there is no node in your subset which is an ancestor of any other node in your subset. For example, if A is the parent of B and B is the parent of C, then you could have at most one of A, B or C in your subset. In addition, you would like exactly $k$ of your chosen nodes to be red.\n\nIf exactly $m$ of the nodes are red, then for all $k=0..m$, figure out how many ways you can choose subsets with $k$ red nodes, and no node is an ancestor of any other node.\n\n-----Input-----\nEach input will consist of a single test case. Note that your program may be run multiple times on different inputs. Each test case will begin with a line with two integers $n$ ($1 \\le n \\le 2 \\times 10^5$) and $m$ ($0 \\le m \\le min(10^3,\\ n)$), where $n$ is the number of nodes in the tree, and $m$ is the number of nodes which are red. The nodes are numbered $1..n$.\n\nEach of the next $n-1$ lines will contain a single integer $p$ ($1 \\le p \\le n$), which is the number of the parent of this node. The nodes are listed in order, starting with node $2$, then node $3$, and so on. Node $1$ is skipped, since it is the root. It is guaranteed that the nodes form a single tree, with a single root at node $1$ and no cycles.\n\nEach of the next $m$ lines will contain single integer $r$ ($1 \\le r \\le n$). These are the numbers of the red nodes. No value of $r$ will be repeated.\n\n-----Output-----\nOutput $m+1$ lines, corresponding to the number of subsets satisfying the given criteria with a number of red nodes equal to $k=0..m$, in that order. Output this number modulo $10^9+7$.\n\n-----Examples-----\nSample Input 1:\n4 1\n1\n1\n1\n3\nSample Output 1:\n5\n4\n\nSample Input 2:\n4 4\n1\n1\n1\n1\n2\n3\n4\nSample Output 2:\n1\n4\n3\n1\n0\nPlease note", "QUESTION:\nYou are given a rooted tree with $n$ nodes. The nodes are numbered $1..n$. The root is node $1$, and $m$ of the nodes are colored red, the rest are black.\n\nYou would like to choose a subset of nodes such that there is no node in your subset which is an ancestor of any other node in your subset. For example, if A is the parent of B and B is the parent of C, then you could have at most one of A, B or C in your subset. In addition, you would like exactly $k$ of your chosen nodes to be red.\n\nIf exactly $m$ of the nodes are red, then for all $k=0..m$, figure out how many ways you can choose subsets with $k$ red nodes, and no node is an ancestor of any other node.\n\n-----Input-----\nEach input will consist of a single test case. Note that your program may be run multiple times on different inputs. Each test case will begin with a line with two integers $n$ ($1 \\le n \\le 2 \\times 10^5$) and $m$ ($0 \\le m \\le min(10^3,\\ n)$), where $n$ is the number of nodes in the tree, and $m$ is the number of nodes which are red. The nodes are numbered $1..n$.\n\nEach of the next $n-1$ lines will contain a single integer $p$ ($1 \\le p \\le n$), which is the number of the parent of this node. The nodes are listed in order, starting with node $2$, then node $3$, and so on. Node $1$ is skipped, since it is the root. It is guaranteed that the nodes form a single tree, with a single root at node $1$ and no cycles.\n\nEach of the next $m$ lines will contain single integer $r$ ($1 \\le r \\le n$). These are the numbers of the red nodes. No value of $r$ will be repeated.\n\n-----Output-----\nOutput $m+1$ lines, corresponding to the number of subsets satisfying the given criteria with a number of red nodes equal to $k=0..m$, in that order. Output this number modulo $10^9+7$.\n\n-----Examples-----\nSample Input 1:\n4 1\n1\n1\n1\n3\nSample Output 1:\n5\n4\n\nSample Input 2:\n4 4\n1\n1\n1\n1\n2\n3\n4\nSample Output 2:\n1\n4\n3\n1\n0\nPlease note", "QUESTION:\nYou are given a rooted tree with $n$ nodes. The nodes are numbered $1..n$. The root is node $1$, and $m$ of the nodes are colored red, the rest are black.\n\nYou would like to choose a subset of nodes such that there is no node in your subset which is an ancestor of any other node in your subset. For example, if A is the parent of B and B is the parent of C, then you could have at most one of A, B or C in your subset. In addition, you would like exactly $k$ of your chosen nodes to be red.\n\nIf exactly $m$ of the nodes are red, then for all $k=0..m$, figure out how many ways you can choose subsets with $k$ red nodes, and no node is an ancestor of any other node.\n\n-----Input-----\nEach input will consist of a single test case. Note that your program may be run multiple times on different inputs. Each test case will begin with a line with two integers $n$ ($1 \\le n \\le 2 \\times 10^5$) and $m$ ($0 \\le m \\le min(10^3,\\ n)$), where $n$ is the number of nodes in the tree, and $m$ is the number of nodes which are red. The nodes are numbered $1..n$.\n\nEach of the next $n-1$ lines will contain a single integer $p$ ($1 \\le p \\le n$), which is the number of the parent of this node. The nodes are listed in order, starting with node $2$, then node $3$, and so on. Node $1$ is skipped, since it is the root. It is guaranteed that the nodes form a single tree, with a single root at node $1$ and no cycles.\n\nEach of the next $m$ lines will contain single integer $r$ ($1 \\le r \\le n$). These are the numbers of the red nodes. No value of $r$ will be repeated.\n\n-----Output-----\nOutput $m+1$ lines, corresponding to the number of subsets satisfying the given criteria with a number of red nodes equal to $k=0..m$, in that order. Output this number modulo $10^9+7$.\n\n-----Examples-----\nSample Input 1:\n4 1\n1\n1\n1\n3\nSample Output 1:\n5\n4\n\nSample Input 2:\n4 4\n1\n1\n1\n1\n2\n3\n4\nSample Output 2:\n1\n4\n3\n1\n0\nPlease note", "QUESTION:\nYou are given a rooted tree with $n$ nodes. The nodes are numbered $1..n$. The root is node $1$, and $m$ of the nodes are colored red, the rest are black.\n\nYou would like to choose a subset of nodes such that there is no node in your subset which is an ancestor of any other node in your subset. For example, if A is the parent of B and B is the parent of C, then you could have at most one of A, B or C in your subset. In addition, you would like exactly $k$ of your chosen nodes to be red.\n\nIf exactly $m$ of the nodes are red, then for all $k=0..m$, figure out how many ways you can choose subsets with $k$ red nodes, and no node is an ancestor of any other node.\n\n-----Input-----\nEach input will consist of a single test case. Note that your program may be run multiple times on different inputs. Each test case will begin with a line with two integers $n$ ($1 \\le n \\le 2 \\times 10^5$) and $m$ ($0 \\le m \\le min(10^3,\\ n)$), where $n$ is the number of nodes in the tree, and $m$ is the number of nodes which are red. The nodes are numbered $1..n$.\n\nEach of the next $n-1$ lines will contain a single integer $p$ ($1 \\le p \\le n$), which is the number of the parent of this node. The nodes are listed in order, starting with node $2$, then node $3$, and so on. Node $1$ is skipped, since it is the root. It is guaranteed that the nodes form a single tree, with a single root at node $1$ and no cycles.\n\nEach of the next $m$ lines will contain single integer $r$ ($1 \\le r \\le n$). These are the numbers of the red nodes. No value of $r$ will be repeated.\n\n-----Output-----\nOutput $m+1$ lines, corresponding to the number of subsets satisfying the given criteria with a number of red nodes equal to $k=0..m$, in that order. Output this number modulo $10^9+7$.\n\n-----Examples-----\nSample Input 1:\n4 1\n1\n1\n1\n3\nSample Output 1:\n5\n4\n\nSample Input 2:\n4 4\n1\n1\n1\n1\n2\n3\n4\nSample Output 2:\n1\n4\n3\n1\n0\nPlease note", "QUESTION:\nYou are given a rooted tree with $n$ nodes. The nodes are numbered $1..n$. The root is node $1$, and $m$ of the nodes are colored red, the rest are black.\n\nYou would like to choose a subset of nodes such that there is no node in your subset which is an ancestor of any other node in your subset. For example, if A is the parent of B and B is the parent of C, then you could have at most one of A, B or C in your subset. In addition, you would like exactly $k$ of your chosen nodes to be red.\n\nIf exactly $m$ of the nodes are red, then for all $k=0..m$, figure out how many ways you can choose subsets with $k$ red nodes, and no node is an ancestor of any other node.\n\n-----Input-----\nEach input will consist of a single test case. Note that your program may be run multiple times on different inputs. Each test case will begin with a line with two integers $n$ ($1 \\le n \\le 2 \\times 10^5$) and $m$ ($0 \\le m \\le min(10^3,\\ n)$), where $n$ is the number of nodes in the tree, and $m$ is the number of nodes which are red. The nodes are numbered $1..n$.\n\nEach of the next $n-1$ lines will contain a single integer $p$ ($1 \\le p \\le n$), which is the number of the parent of this node. The nodes are listed in order, starting with node $2$, then node $3$, and so on. Node $1$ is skipped, since it is the root. It is guaranteed that the nodes form a single tree, with a single root at node $1$ and no cycles.\n\nEach of the next $m$ lines will contain single integer $r$ ($1 \\le r \\le n$). These are the numbers of the red nodes. No value of $r$ will be repeated.\n\n-----Output-----\nOutput $m+1$ lines, corresponding to the number of subsets satisfying the given criteria with a number of red nodes equal to $k=0..m$, in that order. Output this number modulo $10^9+7$.\n\n-----Examples-----\nSample Input 1:\n4 1\n1\n1\n1\n3\nSample Output 1:\n5\n4\n\nSample Input 2:\n4 4\n1\n1\n1\n1\n2\n3\n4\nSample Output 2:\n1\n4\n3\n1\n0\nPlease note"], "prompt": "\nQUESTION:\nYou are given a rooted tree with $n$ nodes. The nodes are numbered $1..n$. The root is node $1$, and $m$ of the nodes are colored red, the rest are black.\n\nYou would like to choose a subset of nodes such that there is no node in your subset which is an ancestor of any other node in your subset. For example, if A is the parent of B and B is the parent of C, then you could have at most one of A, B or C in your subset. In addition, you would like exactly $k$ of your chosen nodes to be red.\n\nIf exactly $m$ of the nodes are red, then for all $k=0..m$, figure out how many ways you can choose subsets with $k$ red nodes, and no node is an ancestor of any other node.\n\n-----Input-----\nEach input will consist of a single test case. Note that your program may be run multiple times on different inputs. Each test case will begin with a line with two integers $n$ ($1 \\le n \\le 2 \\times 10^5$) and $m$ ($0 \\le m \\le min(10^3,\\ n)$), where $n$ is the number of nodes in the tree, and $m$ is the number of nodes which are red. The nodes are numbered $1..n$.\n\nEach of the next $n-1$ lines will contain a single integer $p$ ($1 \\le p \\le n$), which is the number of the parent of this node. The nodes are listed in order, starting with node $2$, then node $3$, and so on. Node $1$ is skipped, since it is the root. It is guaranteed that the nodes form a single tree, with a single root at node $1$ and no cycles.\n\nEach of the next $m$ lines will contain single integer $r$ ($1 \\le r \\le n$). These are the numbers of the red nodes. No value of $r$ will be repeated.\n\n-----Output-----\nOutput $m+1$ lines, corresponding to the number of subsets satisfying the given criteria with a number of red nodes equal to $k=0..m$, in that order. Output this number modulo $10^9+7$.\n\n-----Examples-----\nSample Input 1:\n4 1\n1\n1\n1\n3\nSample Output 1:\n5\n4\n\nSample Input 2:\n4 4\n1\n1\n1\n1\n2\n3\n4\nSample Output 2:\n1\n4\n3\n1\n0\nPlease provide the solution as pure code only, without explanations or comments.\n\nANSWER:\n```python\n"}}