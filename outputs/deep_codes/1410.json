{"1410": {"code": ["QUESTION:\nYou are given a tree consisting of $n$ vertices. A tree is an undirected connected acyclic graph. [Image] Example of a tree. \n\nYou have to paint each vertex into one of three colors. For each vertex, you know the cost of painting it in every color.\n\nYou have to paint the vertices so that any path consisting of exactly three distinct vertices does not contain any vertices with equal colors. In other words, let's consider all triples $(x, y, z)$ such that $x \\neq y, y \\neq z, x \\neq z$, $x$ is connected by an edge with $y$, and $y$ is connected by an edge with $z$. The colours of $x$, $y$ and $z$ should be pairwise distinct. Let's call a painting which meets this condition good.\n\nYou have to calculate the minimum cost of a good painting and find one of the optimal paintings. If there is no good painting, report about it.\n\n\n-----Input-----\n\nThe first line contains one integer $n$ $(3 \\le n \\le 100\\,000)$ \u2014 the number of vertices.\n\nThe second line contains a sequence of integers $c_{1, 1}, c_{1, 2}, \\dots, c_{1, n}$ $(1 \\le c_{1, i} \\le 10^{9})$, where $c_{1, i}$ is the cost of painting the $i$-th vertex into the first color.\n\nThe third line contains a sequence of integers $c_{2, 1}, c_{2, 2}, \\dots, c_{2, n}$ $(1 \\le c_{2, i} \\le 10^{9})$, where $c_{2, i}$ is the cost of painting the $i$-th vertex into the second color.\n\nThe fourth line contains a sequence of integers $c_{3, 1}, c_{3, 2}, \\dots, c_{3, n}$ $(1 \\le c_{3, i} \\le 10^{9})$, where $c_{3, i}$ is the cost of painting the $i$-th vertex into the third color.\n\nThen $(n - 1)$ lines follow, each containing two integers $u_j$ and $v_j$ $(1 \\le u_j, v_j \\le n, u_j \\neq v_j)$ \u2014 the numbers of vertices connected by the $j$-th undirected edge. It is guaranteed that these edges denote a tree.\n\n\n-----Output", "QUESTION:\nYou are given a tree consisting of $n$ vertices. A tree is an undirected connected acyclic graph. [Image] Example of a tree. \n\nYou have to paint each vertex into one of three colors. For each vertex, you know the cost of painting it in every color.\n\nYou have to paint the vertices so that any path consisting of exactly three distinct vertices does not contain any vertices with equal colors. In other words, let's consider all triples $(x, y, z)$ such that $x \\neq y, y \\neq z, x \\neq z$, $x$ is connected by an edge with $y$, and $y$ is connected by an edge with $z$. The colours of $x$, $y$ and $z$ should be pairwise distinct. Let's call a painting which meets this condition good.\n\nYou have to calculate the minimum cost of a good painting and find one of the optimal paintings. If there is no good painting, report about it.\n\n\n-----Input-----\n\nThe first line contains one integer $n$ $(3 \\le n \\le 100\\,000)$ \u2014 the number of vertices.\n\nThe second line contains a sequence of integers $c_{1, 1}, c_{1, 2}, \\dots, c_{1, n}$ $(1 \\le c_{1, i} \\le 10^{9})$, where $c_{1, i}$ is the cost of painting the $i$-th vertex into the first color.\n\nThe third line contains a sequence of integers $c_{2, 1}, c_{2, 2}, \\dots, c_{2, n}$ $(1 \\le c_{2, i} \\le 10^{9})$, where $c_{2, i}$ is the cost of painting the $i$-th vertex into the second color.\n\nThe fourth line contains a sequence of integers $c_{3, 1}, c_{3, 2}, \\dots, c_{3, n}$ $(1 \\le c_{3, i} \\le 10^{9})$, where $c_{3, i}$ is the cost of painting the $i$-th vertex into the third color.\n\nThen $(n - 1)$ lines follow, each containing two integers $u_j$ and $v_j$ $(1 \\le u_j, v_j \\le n, u_j \\neq v_j)$ \u2014 the numbers of vertices connected by the $j$-th undirected edge. It is guaranteed that these edges denote a tree.\n\n\n-----Output", "QUESTION:\nYou are given a tree consisting of $n$ vertices. A tree is an undirected connected acyclic graph. [Image] Example of a tree. \n\nYou have to paint each vertex into one of three colors. For each vertex, you know the cost of painting it in every color.\n\nYou have to paint the vertices so that any path consisting of exactly three distinct vertices does not contain any vertices with equal colors. In other words, let's consider all triples $(x, y, z)$ such that $x \\neq y, y \\neq z, x \\neq z$, $x$ is connected by an edge with $y$, and $y$ is connected by an edge with $z$. The colours of $x$, $y$ and $z$ should be pairwise distinct. Let's call a painting which meets this condition good.\n\nYou have to calculate the minimum cost of a good painting and find one of the optimal paintings. If there is no good painting, report about it.\n\n\n-----Input-----\n\nThe first line contains one integer $n$ $(3 \\le n \\le 100\\,000)$ \u2014 the number of vertices.\n\nThe second line contains a sequence of integers $c_{1, 1}, c_{1, 2}, \\dots, c_{1, n}$ $(1 \\le c_{1, i} \\le 10^{9})$, where $c_{1, i}$ is the cost of painting the $i$-th vertex into the first color.\n\nThe third line contains a sequence of integers $c_{2, 1}, c_{2, 2}, \\dots, c_{2, n}$ $(1 \\le c_{2, i} \\le 10^{9})$, where $c_{2, i}$ is the cost of painting the $i$-th vertex into the second color.\n\nThe fourth line contains a sequence of integers $c_{3, 1}, c_{3, 2}, \\dots, c_{3, n}$ $(1 \\le c_{3, i} \\le 10^{9})$, where $c_{3, i}$ is the cost of painting the $i$-th vertex into the third color.\n\nThen $(n - 1)$ lines follow, each containing two integers $u_j$ and $v_j$ $(1 \\le u_j, v_j \\le n, u_j \\neq v_j)$ \u2014 the numbers of vertices connected by the $j$-th undirected edge. It is guaranteed that these edges denote a tree.\n\n\n-----Output", "QUESTION:\nYou are given a tree consisting of $n$ vertices. A tree is an undirected connected acyclic graph. [Image] Example of a tree. \n\nYou have to paint each vertex into one of three colors. For each vertex, you know the cost of painting it in every color.\n\nYou have to paint the vertices so that any path consisting of exactly three distinct vertices does not contain any vertices with equal colors. In other words, let's consider all triples $(x, y, z)$ such that $x \\neq y, y \\neq z, x \\neq z$, $x$ is connected by an edge with $y$, and $y$ is connected by an edge with $z$. The colours of $x$, $y$ and $z$ should be pairwise distinct. Let's call a painting which meets this condition good.\n\nYou have to calculate the minimum cost of a good painting and find one of the optimal paintings. If there is no good painting, report about it.\n\n\n-----Input-----\n\nThe first line contains one integer $n$ $(3 \\le n \\le 100\\,000)$ \u2014 the number of vertices.\n\nThe second line contains a sequence of integers $c_{1, 1}, c_{1, 2}, \\dots, c_{1, n}$ $(1 \\le c_{1, i} \\le 10^{9})$, where $c_{1, i}$ is the cost of painting the $i$-th vertex into the first color.\n\nThe third line contains a sequence of integers $c_{2, 1}, c_{2, 2}, \\dots, c_{2, n}$ $(1 \\le c_{2, i} \\le 10^{9})$, where $c_{2, i}$ is the cost of painting the $i$-th vertex into the second color.\n\nThe fourth line contains a sequence of integers $c_{3, 1}, c_{3, 2}, \\dots, c_{3, n}$ $(1 \\le c_{3, i} \\le 10^{9})$, where $c_{3, i}$ is the cost of painting the $i$-th vertex into the third color.\n\nThen $(n - 1)$ lines follow, each containing two integers $u_j$ and $v_j$ $(1 \\le u_j, v_j \\le n, u_j \\neq v_j)$ \u2014 the numbers of vertices connected by the $j$-th undirected edge. It is guaranteed that these edges denote a tree.\n\n\n-----Output", "QUESTION:\nYou are given a tree consisting of $n$ vertices. A tree is an undirected connected acyclic graph. [Image] Example of a tree. \n\nYou have to paint each vertex into one of three colors. For each vertex, you know the cost of painting it in every color.\n\nYou have to paint the vertices so that any path consisting of exactly three distinct vertices does not contain any vertices with equal colors. In other words, let's consider all triples $(x, y, z)$ such that $x \\neq y, y \\neq z, x \\neq z$, $x$ is connected by an edge with $y$, and $y$ is connected by an edge with $z$. The colours of $x$, $y$ and $z$ should be pairwise distinct. Let's call a painting which meets this condition good.\n\nYou have to calculate the minimum cost of a good painting and find one of the optimal paintings. If there is no good painting, report about it.\n\n\n-----Input-----\n\nThe first line contains one integer $n$ $(3 \\le n \\le 100\\,000)$ \u2014 the number of vertices.\n\nThe second line contains a sequence of integers $c_{1, 1}, c_{1, 2}, \\dots, c_{1, n}$ $(1 \\le c_{1, i} \\le 10^{9})$, where $c_{1, i}$ is the cost of painting the $i$-th vertex into the first color.\n\nThe third line contains a sequence of integers $c_{2, 1}, c_{2, 2}, \\dots, c_{2, n}$ $(1 \\le c_{2, i} \\le 10^{9})$, where $c_{2, i}$ is the cost of painting the $i$-th vertex into the second color.\n\nThe fourth line contains a sequence of integers $c_{3, 1}, c_{3, 2}, \\dots, c_{3, n}$ $(1 \\le c_{3, i} \\le 10^{9})$, where $c_{3, i}$ is the cost of painting the $i$-th vertex into the third color.\n\nThen $(n - 1)$ lines follow, each containing two integers $u_j$ and $v_j$ $(1 \\le u_j, v_j \\le n, u_j \\neq v_j)$ \u2014 the numbers of vertices connected by the $j$-th undirected edge. It is guaranteed that these edges denote a tree.\n\n\n-----Output"], "prompt": "\nQUESTION:\nYou are given a tree consisting of $n$ vertices. A tree is an undirected connected acyclic graph. [Image] Example of a tree. \n\nYou have to paint each vertex into one of three colors. For each vertex, you know the cost of painting it in every color.\n\nYou have to paint the vertices so that any path consisting of exactly three distinct vertices does not contain any vertices with equal colors. In other words, let's consider all triples $(x, y, z)$ such that $x \\neq y, y \\neq z, x \\neq z$, $x$ is connected by an edge with $y$, and $y$ is connected by an edge with $z$. The colours of $x$, $y$ and $z$ should be pairwise distinct. Let's call a painting which meets this condition good.\n\nYou have to calculate the minimum cost of a good painting and find one of the optimal paintings. If there is no good painting, report about it.\n\n\n-----Input-----\n\nThe first line contains one integer $n$ $(3 \\le n \\le 100\\,000)$ \u2014 the number of vertices.\n\nThe second line contains a sequence of integers $c_{1, 1}, c_{1, 2}, \\dots, c_{1, n}$ $(1 \\le c_{1, i} \\le 10^{9})$, where $c_{1, i}$ is the cost of painting the $i$-th vertex into the first color.\n\nThe third line contains a sequence of integers $c_{2, 1}, c_{2, 2}, \\dots, c_{2, n}$ $(1 \\le c_{2, i} \\le 10^{9})$, where $c_{2, i}$ is the cost of painting the $i$-th vertex into the second color.\n\nThe fourth line contains a sequence of integers $c_{3, 1}, c_{3, 2}, \\dots, c_{3, n}$ $(1 \\le c_{3, i} \\le 10^{9})$, where $c_{3, i}$ is the cost of painting the $i$-th vertex into the third color.\n\nThen $(n - 1)$ lines follow, each containing two integers $u_j$ and $v_j$ $(1 \\le u_j, v_j \\le n, u_j \\neq v_j)$ \u2014 the numbers of vertices connected by the $j$-th undirected edge. It is guaranteed that these edges denote a tree.\n\n\n-----Output-----\n\nIf there is no good painting, print $-1$.\n\nOtherwise, print the minimum cost of a good painting in the first line. In the second line print $n$ integers $b_1, b_2, \\dots, b_n$ $(1 \\le b_i \\le 3)$, where the $i$-th integer should denote the color of the $i$-th vertex. If there are multiple good paintings with minimum cost, print any of them.\n\n\n-----Examples-----\nInput\n3\n3 2 3\n4 3 2\n3 1 3\n1 2\n2 3\n\nOutput\n6\n1 3 2 \n\nInput\n5\n3 4 2 1 2\n4 2 1 5 4\n5 3 2 1 1\n1 2\n3 2\n4 3\n5 3\n\nOutput\n-1\n\nInput\n5\n3 4 2 1 2\n4 2 1 5 4\n5 3 2 1 1\n1 2\n3 2\n4 3\n5 4\n\nOutput\n9\n1 3 2 1 3 \n\n\n\n-----Note-----\n\nAll vertices should be painted in different colors in the first example. The optimal way to do it is to paint the first vertex into color $1$, the second vertex \u2014 into color $3$, and the third vertex \u2014 into color $2$. The cost of this painting is $3 + 2 + 1 = 6$.\nPlease provide the solution as pure code only, without explanations or comments.\n\nANSWER:\n```python\n"}}